"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[6500],{8910:function(t,e,a){a.d(e,{Z:function(){return d}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"modal"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"sign-container"},[e("h3",{staticClass:"sign-title"},[t._v(t._s(t.title||"请在下方区域签名"))]),e("g-sign",{ref:"signBoard",attrs:{"line-width":t.lineWidth,"line-color":t.lineColor,"background-color":t.backgroundColor,"save-format":t.saveFormat},on:{save:t.handleSave,clear:t.handleClear,"save-error":t.handleError}})],1)]),e("div",{staticClass:"modal-footer"},[e("g-btn",{attrs:{text:"确认",type:"primary"},on:{callback:t.save}}),e("g-btn",{attrs:{text:"取消"},on:{callback:function(e){return t.$emit("closeModal")}}})],1)])},n=[],r=a(60704),s={name:"GSignModal",components:{GSign:r.Z},props:{title:{type:String,default:""},lineWidth:{type:Number,default:2},lineColor:{type:String,default:"#000000"},backgroundColor:{type:String,default:"#ffffff"},saveFormat:{type:String,default:"png",validator:t=>["png","jpeg","webp"].includes(t)}},data(){return{signatureData:null,hasSignature:!1}},methods:{handleSave(t){this.signatureData=t,this.hasSignature=!0},handleClear(){this.signatureData=null,this.hasSignature=!1},handleError(t){this.$message.error(t)},save(){this.hasSignature?(this.$emit("success",this.signatureData),this.$emit("closeModal")):this.$message.error("请先进行签名")},clearSignature(){this.$refs.signBoard&&this.$refs.signBoard.clearCanvas()}}},o=s,l=a(1001),c=(0,l.Z)(o,i,n,!1,null,"e39a081c",null),d=c.exports},86500:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var i=function(){var t=this,e=t._self._c;return e("a-form-model",{ref:"form",staticClass:"h-father",attrs:{model:t.entity,layout:"vertical",autocomplete:"off",rules:t.rules}},[e("g-body-form-layout",{scopedSlots:t._u([{key:"search-card",fn:function(){return[e("div",{staticClass:"search-card"},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:4}},[e("a-form-model-item",{attrs:{label:"设备组",prop:"deviceName"}},[e("g-select",{attrs:{placeholder:"请选择设备组"},model:{value:t.entity.deviceName,callback:function(e){t.$set(t.entity,"deviceName",e)},expression:"entity.deviceName"}})],1)],1),e("a-col",{attrs:{span:4}},[e("a-form-model-item",{attrs:{label:"设备",prop:"deviceName"}},[e("g-select",{attrs:{placeholder:"请选择设备"},model:{value:t.entity.deviceName,callback:function(e){t.$set(t.entity,"deviceName",e)},expression:"entity.deviceName"}})],1)],1),e("a-col",{attrs:{span:4}},[e("a-form-model-item",{attrs:{label:"数采模板",prop:"deviceName"}},[e("g-select",{attrs:{placeholder:"请选择数采模板"},model:{value:t.entity.deviceName,callback:function(e){t.$set(t.entity,"deviceName",e)},expression:"entity.deviceName"}})],1)],1),e("a-col",{attrs:{span:4}}),e("a-col",{attrs:{span:4}}),e("a-col",{attrs:{span:4}},[e("div",{staticStyle:{display:"flex","justify-content":"flex-end","align-items":"center",height:"100%"}},[e("g-btn-group",{attrs:{buttonLists:t.btnList},on:{btnCallback:function(e){return t.btnCallback(e)}}})],1)])],1)],1)]},proxy:!0},{key:"expand-card",fn:function(){return[e("div",{staticClass:"expand-card"},[e("g-collapse",{attrs:{headerName:"采集配置"},scopedSlots:t._u([{key:"content",fn:function(){return[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:4}},[e("a-form-model-item",{attrs:{label:"采集类型",prop:"collectionType"}},[e("a-select",{attrs:{placeholder:"请选择采集类型"},on:{change:t.handleCollectionTypeChange},model:{value:t.entity.collectionType,callback:function(e){t.$set(t.entity,"collectionType",e)},expression:"entity.collectionType"}},[e("a-select-option",{attrs:{value:"定时采集"}},[t._v("定时采集")]),e("a-select-option",{attrs:{value:"触发采集"}},[t._v("触发采集")]),e("a-select-option",{attrs:{value:"条件采集"}},[t._v("条件采集")]),e("a-select-option",{attrs:{value:"手动采集"}},[t._v("手动采集")]),e("a-select-option",{attrs:{value:"实时采集"}},[t._v("实时采集")])],1)],1)],1),e("a-col",{attrs:{span:4}},[e("a-form-model-item",{attrs:{label:"设备类型",prop:"deviceType"}},[e("a-select",{attrs:{placeholder:"请选择设备类型"},on:{change:t.handleDeviceTypeChange},model:{value:t.entity.deviceType,callback:function(e){t.$set(t.entity,"deviceType",e)},expression:"entity.deviceType"}},[e("a-select-option",{attrs:{value:"温度传感器"}},[t._v("温度传感器")]),e("a-select-option",{attrs:{value:"湿度传感器"}},[t._v("湿度传感器")]),e("a-select-option",{attrs:{value:"压力传感器"}},[t._v("压力传感器")]),e("a-select-option",{attrs:{value:"振动传感器"}},[t._v("振动传感器")]),e("a-select-option",{attrs:{value:"位移传感器"}},[t._v("位移传感器")])],1)],1)],1),e("a-col",{attrs:{span:4}},[e("a-form-model-item",{attrs:{label:"采集间隔",prop:"interval",rules:t.intervalRules}},[e("a-input",{attrs:{placeholder:"例如：5分钟",disabled:!t.isIntervalEnabled},model:{value:t.entity.interval,callback:function(e){t.$set(t.entity,"interval",e)},expression:"entity.interval"}})],1)],1),e("a-col",{attrs:{span:4}},[e("a-form-model-item",{attrs:{label:"优先级",prop:"priority"}},[e("a-select",{attrs:{placeholder:"请选择优先级"},model:{value:t.entity.priority,callback:function(e){t.$set(t.entity,"priority",e)},expression:"entity.priority"}},[e("a-select-option",{attrs:{value:"高"}},[t._v("高")]),e("a-select-option",{attrs:{value:"中"}},[t._v("中")]),e("a-select-option",{attrs:{value:"低"}},[t._v("低")])],1)],1)],1),e("a-col",{attrs:{span:8}},[e("a-form-model-item",{attrs:{label:"触发条件",prop:"triggerCondition",rules:t.triggerRules}},[e("a-input",{attrs:{placeholder:"请输入触发条件",disabled:!t.isTriggerEnabled},model:{value:t.entity.triggerCondition,callback:function(e){t.$set(t.entity,"triggerCondition",e)},expression:"entity.triggerCondition"}})],1)],1)],1)]},proxy:!0}])})],1)]},proxy:!0},{key:"card-body",fn:function(){return[e("g-collapse",{attrs:{headerName:"基础数据采集"},scopedSlots:t._u([{key:"content",fn:function(){return[e("g-data-points",{attrs:{dataPoints:t.entity.dataPoints,validDataName:"dataPoints"}})]},proxy:!0}])}),e("g-collapse",{attrs:{headerName:"设备状态数据"},scopedSlots:t._u([{key:"content",fn:function(){return[e("g-data-points",{attrs:{dataPoints:t.entity.statusDataPoints,validDataName:"statusDataPoints"}})]},proxy:!0}])}),e("g-collapse",{attrs:{headerName:"数据处理配置"},scopedSlots:t._u([{key:"content",fn:function(){return[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:6}},[e("a-form-model-item",{attrs:{label:"缓存策略",prop:"cacheStrategy"}},[e("a-select",{attrs:{placeholder:"请选择缓存策略"},model:{value:t.entity.cacheStrategy,callback:function(e){t.$set(t.entity,"cacheStrategy",e)},expression:"entity.cacheStrategy"}},[e("a-select-option",{attrs:{value:"不缓存"}},[t._v("不缓存")]),e("a-select-option",{attrs:{value:"缓存最新"}},[t._v("缓存最新")]),e("a-select-option",{attrs:{value:"缓存所有"}},[t._v("缓存所有")])],1)],1)],1),e("a-col",{attrs:{span:6}},[e("a-form-model-item",{attrs:{label:"重试次数",prop:"retryCount"}},[e("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:10},model:{value:t.entity.retryCount,callback:function(e){t.$set(t.entity,"retryCount",e)},expression:"entity.retryCount"}})],1)],1),e("a-col",{attrs:{span:6}},[e("a-form-model-item",{attrs:{label:"重试间隔(秒)",prop:"retryInterval"}},[e("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:60},model:{value:t.entity.retryInterval,callback:function(e){t.$set(t.entity,"retryInterval",e)},expression:"entity.retryInterval"}})],1)],1),e("a-col",{attrs:{span:6}},[e("a-form-model-item",{attrs:{label:"超时时间(秒)",prop:"timeout"}},[e("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:300},model:{value:t.entity.timeout,callback:function(e){t.$set(t.entity,"timeout",e)},expression:"entity.timeout"}})],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:24}},[e("a-form-model-item",{attrs:{label:"数据处理方法",prop:"dataProcessing"}},[e("a-textarea",{attrs:{placeholder:"请输入数据处理方法",rows:4,"max-length":1e3},model:{value:t.entity.dataProcessing,callback:function(e){t.$set(t.entity,"dataProcessing",e)},expression:"entity.dataProcessing"}})],1)],1)],1)]},proxy:!0}])}),e("g-collapse",{attrs:{headerName:"操作描述"},scopedSlots:t._u([{key:"content",fn:function(){return[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{sm:12}},[e("a-form-model-item",{attrs:{name:"description",label:"描述"}},[e("a-textarea",{attrs:{rows:"4",name:"description",placeholder:"请输入采集任务描述","max-length":1e3},model:{value:t.entity.description,callback:function(e){t.$set(t.entity,"description",e)},expression:"entity.description"}})],1)],1)],1)]},proxy:!0}])})]},proxy:!0},{key:"g-fixed-row",fn:function(){return[e("div",{staticClass:"g-fixed-row"},[e("g-btn",{attrs:{size:"large",text:"刷新"},on:{callback:function(e){return t.refresh()}}}),e("g-btn",{attrs:{size:"large",text:"提交",type:"primary"},on:{callback:function(e){return t.submitDataCollection()}}})],1)]},proxy:!0}])})],1)},n=[],r=a(8910),s=a(36026),o=a(58805),l={name:"ResourceDataCollection",data(){return{entity:{deviceName:"",collectionType:"",deviceType:"",interval:"",priority:"中",triggerCondition:"",cacheStrategy:"不缓存",retryCount:3,retryInterval:5,timeout:30,dataProcessing:"",description:"",dataPoints:[{dataValue:"",dataPointName:"温度值",isRequired:!0,dataType:"Float",unit:"℃"},{dataValue:"",dataPointName:"湿度值",isRequired:!1,dataType:"Float",unit:"%"},{dataValue:"",dataPointName:"采集时间",isRequired:!0,dataType:"Timestamp"}],statusDataPoints:[{dataValue:"",dataPointName:"设备运行状态",isRequired:!0,dataType:"Boolean",booleanTrue:"在线",booleanFalse:"离线"},{dataValue:"",dataPointName:"设备电池电量",isRequired:!1,dataType:"Integer",unit:"%"},{dataValue:"",dataPointName:"异常状态码",isRequired:!1,dataType:"String"}]},rules:{deviceName:[{required:!0,message:"请选择设备",trigger:"change"}],collectionType:[{required:!0,message:"请选择采集类型",trigger:"change"}],deviceType:[{required:!0,message:"请选择设备类型",trigger:"change"}],priority:[{required:!0,message:"请选择优先级",trigger:"change"}]},intervalRules:[{required:!0,message:"请输入采集间隔",trigger:"blur"},{pattern:/^\d+[分秒]钟?$/,message:"格式必须为数字+分钟或数字+秒",trigger:"blur"}],triggerRules:[{required:!0,message:"请输入触发条件",trigger:"blur"}],isIntervalEnabled:!1,isTriggerEnabled:!1,btnList:[{icon:o.Z.icon.documentShow,text:o.Z.button.documentShow,eventName:o.Z.button.documentShow,display:!0}]}},watch:{"entity.deviceName":{handler(){this.$refs.form.validateField("deviceName")}}},mounted(){this.entity.collectionType="定时采集",this.entity.deviceType="温度传感器",this.handleCollectionTypeChange(this.entity.collectionType)},methods:{submitDataCollection(){this.$refs.form.validate().then((t=>{t&&this.createSignModal()}))},createSignModal(){(0,s.f7)({title:"签名",width:"600px"},{component:r.Z,success:t=>{console.log(t),this.$message.success("数据采集任务提交成功"),this.refresh()}})},refresh(){this.$refs.form.resetFields(),this.entity.collectionType="定时采集",this.entity.deviceType="温度传感器",this.entity.priority="中",this.entity.cacheStrategy="不缓存",this.entity.retryCount=3,this.entity.retryInterval=5,this.entity.timeout=30,this.handleCollectionTypeChange(this.entity.collectionType)},handleCollectionTypeChange(t){console.log("采集类型变更:",t),this.isIntervalEnabled="定时采集"===t||"实时采集"===t,this.isTriggerEnabled="触发采集"===t||"条件采集"===t,this.isIntervalEnabled?(this.entity.interval=this.entity.interval||"5分钟",this.entity.triggerCondition=""):this.isTriggerEnabled?(this.entity.interval="",this.entity.triggerCondition=this.entity.triggerCondition||"温度 > 30"):(this.entity.interval="",this.entity.triggerCondition="")},handleDeviceTypeChange(t){console.log("设备类型变更:",t),this.updateDataPointsByDeviceType(t)},updateDataPointsByDeviceType(t){switch(this.entity.dataPoints=[],t){case"温度传感器":this.entity.dataPoints.push({dataValue:"",dataPointName:"温度值",isRequired:!0,dataType:"Float",unit:"℃"},{dataValue:"",dataPointName:"环境温度",isRequired:!1,dataType:"Float",unit:"℃"});break;case"湿度传感器":this.entity.dataPoints.push({dataValue:"",dataPointName:"湿度值",isRequired:!0,dataType:"Float",unit:"%"},{dataValue:"",dataPointName:"露点温度",isRequired:!1,dataType:"Float",unit:"℃"});break;case"压力传感器":this.entity.dataPoints.push({dataValue:"",dataPointName:"压力值",isRequired:!0,dataType:"Float",unit:"kPa"},{dataValue:"",dataPointName:"压力变化率",isRequired:!1,dataType:"Float",unit:"kPa/s"});break;case"振动传感器":this.entity.dataPoints.push({dataValue:"",dataPointName:"振动频率",isRequired:!0,dataType:"Float",unit:"Hz"},{dataValue:"",dataPointName:"振动幅度",isRequired:!0,dataType:"Float",unit:"mm"});break;case"位移传感器":this.entity.dataPoints.push({dataValue:"",dataPointName:"位移值",isRequired:!0,dataType:"Float",unit:"mm"},{dataValue:"",dataPointName:"位移速度",isRequired:!1,dataType:"Float",unit:"mm/s"});break}this.entity.dataPoints.push({dataValue:"",dataPointName:"采集时间",isRequired:!0,dataType:"Timestamp"})}}},c=l,d=a(1001),u=(0,d.Z)(c,i,n,!1,null,"94104afe",null),p=u.exports}}]);
//# sourceMappingURL=6500.49ddf5e6.js.map