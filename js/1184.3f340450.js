"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[1184],{51184:function(t,e,i){i.r(e),i.d(e,{default:function(){return c}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"poster-canvas",on:{dragover:function(t){t.preventDefault()},drop:t.handleDrop}},[e("div",{staticClass:"canvas-container"},[e("div",{staticClass:"canvas-grid"}),e("div",{staticClass:"canvas-size-controller"},[e("a-input-number",{attrs:{min:100,max:2e3},on:{change:t.handleCanvasSizeChange},model:{value:t.canvasWidth,callback:function(e){t.canvasWidth=e},expression:"canvasWidth"}}),e("span",{staticClass:"size-separator"},[t._v("Ã—")]),e("a-input-number",{attrs:{min:100,max:2e3},on:{change:t.handleCanvasSizeChange},model:{value:t.canvasHeight,callback:function(e){t.canvasHeight=e},expression:"canvasHeight"}})],1),e("div",{staticClass:"canvas-content",style:{width:`${t.canvasWidth}px`,height:`${t.canvasHeight}px`}},t._l(t.value,(function(i){return e("div",{key:i.id,staticClass:"canvas-element",class:{"is-selected":t.selectedElement?.id===i.id},style:t.getElementStyle(i),on:{click:function(e){return e.stopPropagation(),t.handleSelect(i)},mousedown:function(e){return e.stopPropagation(),t.handleElementMouseDown(e,i)}}},["text"===i.type?[e("div",{staticClass:"text-content",style:t.getTextStyle(i)},[t._v(" "+t._s(i.content)+" ")])]:t._e(),"image"===i.type?[e("img",{style:t.getImageStyle(i),attrs:{src:i.url,draggable:"false"}})]:t._e(),"shape"===i.type?[e("div",{staticClass:"shape-content",style:t.getShapeStyle(i)})]:t._e(),"qrcode"===i.type?[e("div",{staticClass:"qrcode-content"},[e("qrcode",{attrs:{value:i.content,size:Math.min(i.style.width,i.style.height),level:"H",foreground:i.style.color||"#000000",background:i.style.backgroundColor||"#FFFFFF"}})],1)]:t._e(),t.selectedElement?.id===i.id?[t._l(t.controlPoints,(function(s,a){return e("div",{key:a,staticClass:"control-point",class:s.class,style:t.getControlPointStyle(s),on:{mousedown:function(e){return e.stopPropagation(),t.handleControlPointMouseDown(e,s,i)}}})})),e("div",{staticClass:"rotate-handle",on:{mousedown:function(e){return e.stopPropagation(),t.handleRotateStart(e,i)}}})]:t._e()],2)})),0)])])},a=[],n=i(69574),l={name:"PosterCanvas",components:{qrcode:n.Z},props:{value:{type:Array,default:()=>[]},selectedElement:{type:Object,default:null}},emits:["update:value","select","change"],data(){return{canvasWidth:750,canvasHeight:1334,isDragging:!1,startX:0,startY:0,originalPosition:null,originalSize:null,isResizing:!1,resizeType:"",isRotating:!1,rotateStartAngle:0,controlPoints:[{class:"nw",cursor:"nw-resize",x:0,y:0},{class:"n",cursor:"n-resize",x:.5,y:0},{class:"ne",cursor:"ne-resize",x:1,y:0},{class:"w",cursor:"w-resize",x:0,y:.5},{class:"e",cursor:"e-resize",x:1,y:.5},{class:"sw",cursor:"sw-resize",x:0,y:1},{class:"s",cursor:"s-resize",x:.5,y:1},{class:"se",cursor:"se-resize",x:1,y:1}]}},mounted(){document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)},beforeUnmount(){document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp)},methods:{handleDrop(t){t.preventDefault();const e=t.dataTransfer.getData("componentType");if(!e)return;const i=t.currentTarget.getBoundingClientRect(),s=t.clientX-i.left,a=t.clientY-i.top;this.$emit("add",{type:e,style:{left:s,top:a}})},handleSelect(t){this.$emit("select",t)},handleElementMouseDown(t,e){t.target.closest(".control-point")||t.target.closest(".rotate-handle")||(t.stopPropagation(),this.isDragging=!0,this.startX=t.clientX,this.startY=t.clientY,this.originalPosition={left:e.style.left,top:e.style.top},this.handleSelect(e))},handleCanvasSizeChange(){this.$emit("change",this.value)},getElementStyle(t){return{position:"absolute",left:`${t.style.left}px`,top:`${t.style.top}px`,width:`${t.style.width}px`,height:`${t.style.height}px`,transform:`rotate(${t.style.rotate||0}deg)`,opacity:(t.style.opacity||100)/100,cursor:this.isDragging&&this.selectedElement?.id===t.id?"move":"pointer"}},getTextStyle(t){return{fontFamily:t.style.fontFamily||"Arial",fontSize:`${t.style.fontSize||14}px`,color:t.style.color||"#000000",textAlign:t.style.textAlign||"left",width:"100%",height:"100%",wordBreak:"break-word",overflow:"hidden"}},getImageStyle(t){return{width:"100%",height:"100%",objectFit:t.style.objectFit||"cover"}},getShapeStyle(t){return{width:"100%",height:"100%",backgroundColor:t.style.backgroundColor||"#000000",borderRadius:t.style.borderRadius||"0"}},getControlPointStyle(t){return{left:100*t.x+"%",top:100*t.y+"%",cursor:t.cursor}},handleControlPointMouseDown(t,e,i){t.stopPropagation(),this.isResizing=!0,this.resizeType=e.class,this.startX=t.clientX,this.startY=t.clientY,this.originalSize={width:i.style.width,height:i.style.height,left:i.style.left,top:i.style.top}},handleRotateStart(t,e){if(t.stopPropagation(),this.isRotating=!0,t.target.closest(".canvas-element")){const i=t.target.closest(".canvas-element").getBoundingClientRect(),s=i.left+i.width/2,a=i.top+i.height/2;this.rotateStartAngle=180*Math.atan2(t.clientY-a,t.clientX-s)/Math.PI-(e.style.rotate||0)}},handleMouseMove(t){this.selectedElement&&(this.isResizing?this.handleResize(t):this.isRotating?this.handleRotate(t):this.isDragging&&this.handleDrag(t))},handleMouseUp(){(this.isResizing||this.isRotating||this.isDragging)&&this.$emit("change",this.value),this.isResizing=!1,this.isRotating=!1,this.isDragging=!1},handleResize(t){const e=t.clientX-this.startX,i=t.clientY-this.startY,s=this.selectedElement,a={...s.style};switch(this.resizeType){case"nw":a.width=this.originalSize.width-e,a.height=this.originalSize.height-i,a.left=this.originalSize.left+e,a.top=this.originalSize.top+i;break;case"n":a.height=this.originalSize.height-i,a.top=this.originalSize.top+i;break;case"ne":a.width=this.originalSize.width+e,a.height=this.originalSize.height-i,a.top=this.originalSize.top+i;break;case"w":a.width=this.originalSize.width-e,a.left=this.originalSize.left+e;break;case"e":a.width=this.originalSize.width+e;break;case"sw":a.width=this.originalSize.width-e,a.height=this.originalSize.height+i,a.left=this.originalSize.left+e;break;case"s":a.height=this.originalSize.height+i;break;case"se":a.width=this.originalSize.width+e,a.height=this.originalSize.height+i;break}a.width=Math.max(10,a.width),a.height=Math.max(10,a.height),s.style=a,this.$emit("update:value",[...this.value])},handleRotate(t){const e=this.selectedElement;if(t.target.closest(".canvas-element")){const i=t.target.closest(".canvas-element").getBoundingClientRect(),s=i.left+i.width/2,a=i.top+i.height/2,n=180*Math.atan2(t.clientY-a,t.clientX-s)/Math.PI-this.rotateStartAngle;e.style.rotate=n,this.$emit("update:value",[...this.value])}},handleDrag(t){const e=t.clientX-this.startX,i=t.clientY-this.startY,s=this.selectedElement;s.style.left=this.originalPosition.left+e,s.style.top=this.originalPosition.top+i,this.$emit("update:value",[...this.value])}}},o=l,r=i(1001),h=(0,r.Z)(o,s,a,!1,null,"0270f42a",null),c=h.exports}}]);
//# sourceMappingURL=1184.3f340450.js.map