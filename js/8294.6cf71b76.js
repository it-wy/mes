"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[8294],{42570:function(t,e,a){a.d(e,{Z:function(){return u}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"modal"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"sign-container"},[e("h3",{staticClass:"sign-title"},[t._v(t._s(t.title||"请在下方区域签名"))]),e("g-sign",{ref:"signBoard",attrs:{"line-width":t.lineWidth,"line-color":t.lineColor,"background-color":t.backgroundColor,"save-format":t.saveFormat},on:{save:t.handleSave,clear:t.handleClear,"save-error":t.handleError}})],1)]),e("div",{staticClass:"modal-footer"},[e("g-btn",{attrs:{text:"确认",type:"primary"},on:{callback:t.save}}),e("g-btn",{attrs:{text:"取消"},on:{callback:function(e){return t.$emit("closeModal")}}})],1)])},n=[],i=a(60704),s={name:"GSignModal",components:{GSign:i.Z},props:{title:{type:String,default:""},lineWidth:{type:Number,default:2},lineColor:{type:String,default:"#000000"},backgroundColor:{type:String,default:"#ffffff"},saveFormat:{type:String,default:"png",validator:t=>["png","jpeg","webp"].includes(t)}},data(){return{signatureData:null,hasSignature:!1}},methods:{handleSave(t){this.signatureData=t,this.hasSignature=!0},handleClear(){this.signatureData=null,this.hasSignature=!1},handleError(t){this.$message.error(t)},save(){this.hasSignature?(this.$emit("success",this.signatureData),this.$emit("closeModal")):this.$message.error("请先进行签名")},clearSignature(){this.$refs.signBoard&&this.$refs.signBoard.clearCanvas()}}},o=s,l=a(1001),c=(0,l.Z)(o,r,n,!1,null,"b8f67d68",null),u=c.exports},8294:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var r=function(){var t=this,e=t._self._c;return e("a-form-model",{ref:"form",staticClass:"h-father",attrs:{model:t.entity,layout:"vertical",autocomplete:"off",rules:t.rules}},[e("g-body-form-layout",{scopedSlots:t._u([{key:"search-card",fn:function(){return[e("div",{staticClass:"search-card"},[e("g-container-list",{attrs:{value:t.entity.containerName},on:{"update:value":function(e){return t.$set(t.entity,"containerName",e)}}})],1)]},proxy:!0},{key:"expand-card",fn:function(){return[e("div",{staticClass:"expand-card"},[e("g-collapse",{attrs:{headerName:"批次信息"},scopedSlots:t._u([{key:"content",fn:function(){return[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:6}},[e("a-form-model-item",{attrs:{label:"批次编号"}},[e("a-input",{attrs:{disabled:""},model:{value:t.entity.batchNo,callback:function(e){t.$set(t.entity,"batchNo",e)},expression:"entity.batchNo"}})],1)],1),e("a-col",{attrs:{span:6}},[e("a-form-model-item",{attrs:{label:"物料编码"}},[e("a-input",{attrs:{disabled:""},model:{value:t.entity.materialCode,callback:function(e){t.$set(t.entity,"materialCode",e)},expression:"entity.materialCode"}})],1)],1),e("a-col",{attrs:{span:6}},[e("a-form-model-item",{attrs:{label:"物料名称"}},[e("a-input",{attrs:{disabled:""},model:{value:t.entity.materialName,callback:function(e){t.$set(t.entity,"materialName",e)},expression:"entity.materialName"}})],1)],1),e("a-col",{attrs:{span:6}},[e("a-form-model-item",{attrs:{label:"当前状态"}},[e("a-input",{attrs:{disabled:""},model:{value:t.entity.currentStatus,callback:function(e){t.$set(t.entity,"currentStatus",e)},expression:"entity.currentStatus"}})],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:6}},[e("a-form-model-item",{attrs:{label:"供应商",prop:"supplier"}},[e("a-input",{model:{value:t.entity.supplier,callback:function(e){t.$set(t.entity,"supplier",e)},expression:"entity.supplier"}})],1)],1),e("a-col",{attrs:{span:6}},[e("a-form-model-item",{attrs:{label:"生产日期",prop:"productionDate"}},[e("a-date-picker",{staticStyle:{width:"100%"},model:{value:t.entity.productionDate,callback:function(e){t.$set(t.entity,"productionDate",e)},expression:"entity.productionDate"}})],1)],1)],1)]},proxy:!0}])})],1)]},proxy:!0},{key:"card-body",fn:function(){return[e("g-collapse",{attrs:{headerName:"数据采集"},scopedSlots:t._u([{key:"content",fn:function(){return[e("g-data-points",{attrs:{dataPoints:t.entity.dataPoints,validDataName:"dataPoints"}})]},proxy:!0}])}),e("g-collapse",{attrs:{headerName:"修改原因"},scopedSlots:t._u([{key:"content",fn:function(){return[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:12}},[e("a-form-model-item",{attrs:{label:"修改原因",prop:"changeReason",rules:[{required:!0,message:"请输入修改原因"}]}},[e("a-textarea",{attrs:{rows:"4",placeholder:"请输入修改原因","max-length":1e3},model:{value:t.entity.changeReason,callback:function(e){t.$set(t.entity,"changeReason",e)},expression:"entity.changeReason"}})],1)],1)],1)]},proxy:!0}])})]},proxy:!0},{key:"g-fixed-row",fn:function(){return[e("div",{staticClass:"g-fixed-row"},[e("g-btn",{attrs:{size:"large",text:"刷新"},on:{callback:function(e){return t.refresh()}}}),e("g-btn",{attrs:{size:"large",text:"提交",type:"primary"},on:{callback:function(e){return t.submitChange()}}})],1)]},proxy:!0}])})],1)},n=[],i=a(42570),s=a(36026),o=a(30381),l=a.n(o),c={name:"DataV2InfoUpdate",data(){return{entity:{containerName:"",batchNo:"",materialCode:"",materialName:"",currentStatus:"",supplier:"",productionDate:null,changeReason:"",dataPoints:[{dataValue:"",dataPointName:"操作人员",isRequired:!0,dataType:"String"},{dataValue:"",dataPointName:"操作时间",isRequired:!0,dataType:"Timestamp"}]},rules:{containerName:[{required:!0,message:"请选择批次",trigger:"change"}],supplier:[{required:!0,message:"请输入供应商",trigger:"blur"}],productionDate:[{required:!0,message:"请选择生产日期",trigger:"change"}],changeReason:[{required:!0,message:"请输入修改原因",trigger:"blur"}]}}},watch:{"entity.containerName":{handler(){this.$refs.form&&this.$refs.form.validateField("containerName"),this.entity.containerName&&this.fetchBatchInfo()}}},mounted(){},methods:{fetchBatchInfo(){setTimeout((()=>{this.entity.batchNo="B"+Math.floor(1e4*Math.random()),this.entity.materialCode="M"+Math.floor(1e4*Math.random()),this.entity.materialName="测试物料",this.entity.currentStatus="在库",this.entity.supplier="供应商"+Math.floor(10*Math.random()),this.entity.productionDate=l()().subtract(Math.floor(30*Math.random()),"days")}),500)},submitChange(){this.$refs.form.validate().then((t=>{t&&this.createSignModal()}))},createSignModal(){(0,s.f7)({title:"签名确认",width:"600px"},{component:i.Z,success:t=>{console.log("签名信息:",t),this.saveInfoUpdate()}})},saveInfoUpdate(){const t={...this.entity,productionDate:this.entity.productionDate?this.entity.productionDate.format("YYYY-MM-DD"):null};console.log("提交的数据:",t),this.$message.success("批次信息更新成功"),this.refresh()},refresh(){this.entity={containerName:"",batchNo:"",materialCode:"",materialName:"",currentStatus:"",supplier:"",productionDate:null,changeReason:"",dataPoints:[{dataValue:"",dataPointName:"操作人员",isRequired:!0,dataType:"String"},{dataValue:"",dataPointName:"操作时间",isRequired:!0,dataType:"Timestamp"}]}}}},u=c,d=a(1001),m=(0,d.Z)(u,r,n,!1,null,"879667fc",null),p=m.exports}}]);
//# sourceMappingURL=8294.6cf71b76.js.map