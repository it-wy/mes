"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[5982],{15982:function(t,a,e){e.r(a),e.d(a,{default:function(){return h}});var s=function(){var t=this,a=t._self._c;return a("div",{staticClass:"flex-user"},[a("div",{staticStyle:{"background-color":"#fff","margin-bottom":"10px",padding:"12px 24px","box-sizing":"border-box","border-radius":"4px"}},[a("a-form",{attrs:{form:t.form,layout:"vertical"}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:4}},[a("a-form-item",{attrs:{label:"设备名称"}},[a("a-input",{attrs:{placeholder:"请输入设备名称"},model:{value:t.form.deviceName,callback:function(a){t.$set(t.form,"deviceName",a)},expression:"form.deviceName"}})],1)],1),a("a-col",{attrs:{span:4}},[a("a-form-item",{attrs:{label:"故障类型"}},[a("a-select",{attrs:{placeholder:"请选择故障类型"},model:{value:t.form.faultType,callback:function(a){t.$set(t.form,"faultType",a)},expression:"form.faultType"}},[a("a-select-option",{attrs:{value:"硬件故障"}},[t._v("硬件故障")]),a("a-select-option",{attrs:{value:"软件故障"}},[t._v("软件故障")]),a("a-select-option",{attrs:{value:"网络故障"}},[t._v("网络故障")]),a("a-select-option",{attrs:{value:"其他故障"}},[t._v("其他故障")])],1)],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-item",{attrs:{label:"发生时间"}},[a("a-range-picker",{staticStyle:{width:"100%"},attrs:{"show-time":"",format:"YYYY-MM-DD HH:mm:ss"},model:{value:t.form.occurrenceTime,callback:function(a){t.$set(t.form,"occurrenceTime",a)},expression:"form.occurrenceTime"}})],1)],1),a("a-col",{attrs:{span:4}},[a("a-form-item",{attrs:{label:"故障状态"}},[a("a-select",{attrs:{placeholder:"请选择故障状态"},model:{value:t.form.faultStatus,callback:function(a){t.$set(t.form,"faultStatus",a)},expression:"form.faultStatus"}},[a("a-select-option",{attrs:{value:"未处理"}},[t._v("未处理")]),a("a-select-option",{attrs:{value:"处理中"}},[t._v("处理中")]),a("a-select-option",{attrs:{value:"已解决"}},[t._v("已解决")]),a("a-select-option",{attrs:{value:"已关闭"}},[t._v("已关闭")])],1)],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-item",{attrs:{label:" "}},[a("g-btn",{staticClass:"mr-2",attrs:{text:"查询",type:"primary"},on:{callback:t.search}}),a("g-btn",{attrs:{text:"重置"},on:{callback:t.reset}})],1)],1)],1)],1)],1),a("div",{staticStyle:{"background-color":"#fff",padding:"12px 24px 0","box-sizing":"border-box","overflow-y":"hidden","border-radius":"4px"}},[a("g-table-bar",{attrs:{spacing:t.tableSize,columns:t.columns,virtualColumns:t.virtualColumns},on:{"update:spacing":function(a){t.tableSize=a},"update:columns":function(a){t.columns=a},refreshTable:t.refresh}},[a("g-btn",{staticStyle:{"margin-right":"10px"},attrs:{text:"导出 Excel"}})],1),a("a-table",{attrs:{id:"tables",columns:t.columns,"data-source":t.dataList,scroll:{y:t.tableheight},"row-key":t=>t.id,pagination:t.pagination,loading:t.isTableLoading,size:t.tableSize},on:{change:t.tableChange},scopedSlots:t._u([{key:"status",fn:function(e){return a("span",{},[a("a-tag",{attrs:{color:t.getStatusColor(e)}},[t._v(t._s(e))])],1)}},{key:"action",fn:function(e,s){return a("span",{},[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.showDetails(s)}}},[t._v("详情")]),a("a-divider",{attrs:{type:"vertical"}}),"已关闭"!==s.faultStatus?a("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.handleFault(s)}}},[t._v("处理")]):t._e(),"已关闭"!==s.faultStatus?a("a-divider",{attrs:{type:"vertical"}}):t._e(),"已关闭"!==s.faultStatus?a("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.closeFault(s)}}},[t._v("关闭")]):t._e()],1)}}])})],1)])},i=[],l=e(37491),r=e(36026),o=e(30381),n=e.n(o),c=e(2136),u={name:"equipment-fault-list",mixins:[r.tL],data(){return{tableheight:0,form:{deviceName:"",faultType:void 0,occurrenceTime:[],faultStatus:void 0},columns:[{title:"序号",dataIndex:"id",key:"id",customRender:(t,a,e)=>`${e+1}`,width:80},{title:"设备名称",dataIndex:"deviceName",key:"deviceName"},{title:"故障类型",dataIndex:"faultType",key:"faultType"},{title:"故障描述",dataIndex:"faultDescription",key:"faultDescription",ellipsis:!0},{title:"发生时间",dataIndex:"occurrenceTime",key:"occurrenceTime",sorter:!0,width:200,customRender:t=>t?n()(t).format("YYYY-MM-DD HH:mm:ss"):""},{title:"故障状态",dataIndex:"faultStatus",key:"faultStatus",scopedSlots:{customRender:"status"}},{title:"处理人",dataIndex:"handler",key:"handler"},{title:"处理时间",dataIndex:"handlingTime",key:"handlingTime",width:200,customRender:t=>t?n()(t).format("YYYY-MM-DD HH:mm:ss"):""},{title:"处理结果",dataIndex:"handlingResult",key:"handlingResult"},{title:"操作",dataIndex:"action",key:"action",scopedSlots:{customRender:"action"},width:200}],virtualColumns:[],dataList:[]}},mounted(){this.virtualColumns=JSON.parse(JSON.stringify(this.columns)).map((t=>(t.checked=!0,t))),this.$nextTick((()=>{this.tableheight=(0,l.W)({id:"tables"})})),this.fetchData({pageSize:10,pageNo:1,successCallback:t=>{this.dataList=t.items,this.pagination.total=t.totalCount}})},methods:{search(){this.refresh()},reset(){this.form={deviceName:"",faultType:void 0,occurrenceTime:[],faultStatus:void 0},this.refresh()},fetchData(t){this.isTableLoading=!0,setTimeout((()=>{const a=[];for(let e=0;e<t.pageSize;e++)a.push({id:(t.pageNo-1)*t.pageSize+e+1,deviceName:"设备"+e,faultType:["硬件故障","软件故障","网络故障","其他故障"][Math.floor(4*Math.random())],faultDescription:"这是故障描述的详细信息，可能会很长。"+e,occurrenceTime:n()().subtract(2*e,"hours"),faultStatus:["未处理","处理中","已解决","已关闭"][Math.floor(4*Math.random())],handler:"张三"+e,handlingTime:Math.random()>.5?n()().subtract(e,"hours"):null,handlingResult:Math.random()>.5?"修复成功":"更换部件"});this.isTableLoading=!1,t.successCallback&&t.successCallback({items:a,totalCount:100})}),500)},showDetails(t){(0,c.Z)({title:"故障详情",width:"600px"},{component:FaultDetail,data:t})},handleFault(t){(0,c.Z)({title:"处理故障",width:"800px"},{component:HandleFault,data:t,success:()=>{this.refresh()}})},closeFault(t){this.$confirm({title:"确认关闭",content:`确认关闭故障 ${t.id} 吗？`,onOk:()=>{this.isTableLoading=!0,setTimeout((()=>{this.isTableLoading=!1;const a=this.dataList.findIndex((a=>a.id===t.id));-1!==a&&(this.dataList[a].faultStatus="已关闭",this.$set(this.dataList,a,this.dataList[a])),this.$message.success("故障已关闭")}),500)}})},getStatusColor(t){switch(t){case"未处理":return"red";case"处理中":return"orange";case"已解决":return"green";case"已关闭":return"gray";default:return"blue"}},tableChange(t,a,e){this.pagination=t,this.fetchData({pageSize:t.pageSize,pageNo:t.current,sortField:e.field,sortOrder:e.order,...this.form,successCallback:t=>{this.dataList=t.items,this.pagination.total=t.totalCount}})}}},d=u,m=e(1001),f=(0,m.Z)(d,s,i,!1,null,"38bd8280",null),h=f.exports}}]);
//# sourceMappingURL=5982.60d6a331.js.map