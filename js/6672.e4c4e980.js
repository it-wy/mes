"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[6672],{36672:function(t,a,e){e.r(a),e.d(a,{default:function(){return m}});var r=function(){var t=this,a=t._self._c;return a("a-form-model",{ref:"form",staticClass:"h-father",attrs:{model:t.formData,layout:"vertical",autocomplete:"off",rules:t.rules}},[a("g-body-form-layout",{scopedSlots:t._u([{key:"search-card",fn:function(){return[a("div",{staticClass:"search-card"},[a("g-container-list",{attrs:{value:t.formData.batchNo},on:{"update:value":function(a){return t.$set(t.formData,"batchNo",a)}}})],1)]},proxy:!0},{key:"expand-card",fn:function(){return[a("div",{staticClass:"expand-card"},[a("g-collapse",{attrs:{headerName:"批次信息"},scopedSlots:t._u([{key:"content",fn:function(){return[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"批次编号"}},[a("a-input",{attrs:{disabled:""},model:{value:t.batchInfo.batchNo,callback:function(a){t.$set(t.batchInfo,"batchNo",a)},expression:"batchInfo.batchNo"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"物料编码"}},[a("a-input",{attrs:{disabled:""},model:{value:t.batchInfo.materialCode,callback:function(a){t.$set(t.batchInfo,"materialCode",a)},expression:"batchInfo.materialCode"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"物料名称"}},[a("a-input",{attrs:{disabled:""},model:{value:t.batchInfo.materialName,callback:function(a){t.$set(t.batchInfo,"materialName",a)},expression:"batchInfo.materialName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"当前状态"}},[a("a-input",{attrs:{disabled:""},model:{value:t.batchInfo.currentStatus,callback:function(a){t.$set(t.batchInfo,"currentStatus",a)},expression:"batchInfo.currentStatus"}})],1)],1)],1)]},proxy:!0}])})],1)]},proxy:!0},{key:"card-body",fn:function(){return[a("g-collapse",{attrs:{headerName:"报工信息"},scopedSlots:t._u([{key:"content",fn:function(){return[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"报工数量",prop:"quantity"}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入数量",min:1},model:{value:t.formData.quantity,callback:function(a){t.$set(t.formData,"quantity",a)},expression:"formData.quantity"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"工位",prop:"workstation"}},[a("a-input",{attrs:{placeholder:"请输入工位"},model:{value:t.formData.workstation,callback:function(a){t.$set(t.formData,"workstation",a)},expression:"formData.workstation"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"操作员",prop:"operator"}},[a("a-input",{attrs:{placeholder:"请输入操作员"},model:{value:t.formData.operator,callback:function(a){t.$set(t.formData,"operator",a)},expression:"formData.operator"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"报工时间",prop:"timestamp"}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:"选择时间","value-format":"YYYY-MM-DD HH:mm:ss"},model:{value:t.formData.timestamp,callback:function(a){t.$set(t.formData,"timestamp",a)},expression:"formData.timestamp"}})],1)],1)],1)]},proxy:!0}])})]},proxy:!0},{key:"g-fixed-row",fn:function(){return[a("div",{staticClass:"g-fixed-row"},[a("g-btn",{attrs:{size:"large",text:"刷新"},on:{callback:t.refresh}}),a("g-btn",{attrs:{size:"large",text:"提交",type:"primary"},on:{callback:t.submitForm}})],1)]},proxy:!0}])})],1)},o=[],s=e(5121),n={name:"Thruput",data(){return{formData:{batchNo:"",quantity:null,workstation:"",operator:"",timestamp:null},batchInfo:{batchNo:"",materialCode:"",materialName:"",currentStatus:""},loading:!1,rules:{quantity:[{required:!0,message:"请输入报工数量",trigger:"blur"}],workstation:[{required:!0,message:"请输入工位",trigger:"blur"}],operator:[{required:!0,message:"请输入操作员",trigger:"blur"}],timestamp:[{required:!0,message:"请选择报工时间",trigger:"change"}]}}},watch:{"formData.batchNo":{handler(t){t?this.fetchBatchInfo(t):Object.assign(this.batchInfo,{batchNo:"",materialCode:"",materialName:"",currentStatus:""})}}},methods:{async submitForm(){try{const t=await this.$refs.form.validate();if(!t)return;this.loading=!0;const a=await s.Z.post("/api/thruput",{...this.formData});a.data.success?(this.$message.success(a.data.message),this.refresh()):this.$message.error(a.data.message)}catch(t){console.error("Error submitting form:",t),this.$message.error("报工失败")}finally{this.loading=!1}},async fetchBatchInfo(t){try{setTimeout((()=>{Object.assign(this.batchInfo,{batchNo:t,materialCode:"M"+Math.floor(1e3*Math.random()),materialName:"模拟物料"+Math.floor(100*Math.random()),currentStatus:"生产中"})}),500)}catch(a){console.error("获取批次信息失败",a),message.error("获取批次信息失败")}},refresh(){Object.assign(this.formData,{batchNo:"",quantity:null,workstation:"",operator:"",timestamp:null}),Object.assign(this.batchInfo,{batchNo:"",materialCode:"",materialName:"",currentStatus:""})}}},l=n,i=e(1001),c=(0,i.Z)(l,r,o,!1,null,"1bccd128",null),m=c.exports}}]);
//# sourceMappingURL=6672.e4c4e980.js.map