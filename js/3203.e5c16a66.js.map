{"version":3,"file":"js/3203.e5c16a66.js","mappings":"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","sources":["webpack://data-v2/./src/views/work-calendar/mfg-calendar/create-or-edit-work-calendar/create-or-edit-work-calendar.vue?1610","webpack://data-v2/src/views/work-calendar/mfg-calendar/create-or-edit-work-calendar/create-or-edit-work-calendar.vue","webpack://data-v2/./src/views/work-calendar/mfg-calendar/create-or-edit-work-calendar/create-or-edit-work-calendar.vue?e1d2","webpack://data-v2/./src/views/work-calendar/mfg-calendar/create-or-edit-work-calendar/create-or-edit-work-calendar.vue"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('a-spin',{attrs:{\"spinning\":_vm.loading}},[_c('a-form-model',{ref:\"form\",attrs:{\"model\":_vm.entity,\"rules\":_vm.rules,\"autocomplete\":\"off\",\"layout\":\"vertical\"}},[_c('div',{staticClass:\"card\"},[_c('a-row',{attrs:{\"gutter\":24}},[_c('a-col',{attrs:{\"sm\":12}},[_c('a-form-model-item',{attrs:{\"label\":\"日期\",\"prop\":\"date\"}},[_c('a-date-picker',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":\"选择日期\",\"value-format\":\"YYYY-MM-DD\"},on:{\"change\":_vm.dateChange},model:{value:(_vm.entity.date),callback:function ($$v) {_vm.$set(_vm.entity, \"date\", $$v)},expression:\"entity.date\"}})],1)],1),_c('a-col',{attrs:{\"sm\":12}},[_c('a-form-model-item',{attrs:{\"label\":\"是否工作日\",\"prop\":\"isWorkDay\"}},[_c('a-switch',{on:{\"change\":_vm.onWorkDayChange},model:{value:(_vm.entity.isWorkDay),callback:function ($$v) {_vm.$set(_vm.entity, \"isWorkDay\", $$v)},expression:\"entity.isWorkDay\"}})],1)],1)],1),(_vm.entity.isWorkDay)?_c('a-row',{attrs:{\"gutter\":24}},[_c('a-col',{attrs:{\"sm\":24}},[_c('a-form-model-item',{attrs:{\"label\":\"班次\"}},[_vm._l((_vm.entity.shifts),function(shift,index){return _c('div',{key:index,staticClass:\"shift-item\"},[_c('a-time-picker',{attrs:{\"placeholder\":\"开始时间\",\"value-format\":\"HH:mm\"},on:{\"change\":function($event){return _vm.shiftTimeChange(index)}},model:{value:(shift.startTime),callback:function ($$v) {_vm.$set(shift, \"startTime\", $$v)},expression:\"shift.startTime\"}}),_c('a-time-picker',{attrs:{\"placeholder\":\"结束时间\",\"value-format\":\"HH:mm\"},on:{\"change\":function($event){return _vm.shiftTimeChange(index)}},model:{value:(shift.endTime),callback:function ($$v) {_vm.$set(shift, \"endTime\", $$v)},expression:\"shift.endTime\"}}),_c('a-input',{staticStyle:{\"width\":\"120px\"},attrs:{\"placeholder\":\"班次名称\"},model:{value:(shift.name),callback:function ($$v) {_vm.$set(shift, \"name\", $$v)},expression:\"shift.name\"}}),_c('a-button',{attrs:{\"type\":\"danger\",\"icon\":\"delete\"},on:{\"click\":function($event){return _vm.removeShift(index)}}})],1)}),_c('a-button',{attrs:{\"type\":\"dashed\",\"icon\":\"plus\"},on:{\"click\":_vm.addShift}},[_vm._v(\"添加班次\")])],2)],1)],1):_vm._e(),(!_vm.entity.isWorkDay)?_c('a-row',{attrs:{\"gutter\":24}},[_c('a-col',{attrs:{\"sm\":24}},[_c('a-form-model-item',{attrs:{\"label\":\"停机时间\"}},[_vm._l((_vm.entity.downtime),function(item,index){return _c('div',{key:index,staticClass:\"downtime-item\"},[_c('a-time-picker',{attrs:{\"placeholder\":\"开始时间\",\"value-format\":\"HH:mm\"},model:{value:(item.startTime),callback:function ($$v) {_vm.$set(item, \"startTime\", $$v)},expression:\"item.startTime\"}}),_c('a-time-picker',{attrs:{\"placeholder\":\"结束时间\",\"value-format\":\"HH:mm\"},model:{value:(item.endTime),callback:function ($$v) {_vm.$set(item, \"endTime\", $$v)},expression:\"item.endTime\"}}),_c('a-input',{staticStyle:{\"width\":\"150px\"},attrs:{\"placeholder\":\"原因\"},model:{value:(item.reason),callback:function ($$v) {_vm.$set(item, \"reason\", $$v)},expression:\"item.reason\"}}),_c('a-button',{attrs:{\"type\":\"danger\",\"icon\":\"delete\"},on:{\"click\":function($event){return _vm.removeDowntime(index)}}})],1)}),_c('a-button',{attrs:{\"type\":\"dashed\",\"icon\":\"plus\"},on:{\"click\":_vm.addDowntime}},[_vm._v(\"添加停机时间\")])],2)],1)],1):_vm._e(),_c('a-row',{attrs:{\"gutter\":24}},[_c('a-col',{attrs:{\"sm\":24}},[_c('a-form-model-item',{attrs:{\"label\":\"备注\",\"prop\":\"remark\"}},[_c('a-textarea',{attrs:{\"placeholder\":\"备注\",\"rows\":4,\"max-length\":1000},model:{value:(_vm.entity.remark),callback:function ($$v) {_vm.$set(_vm.entity, \"remark\", $$v)},expression:\"entity.remark\"}})],1)],1)],1)],1),_c('g-collapse',{attrs:{\"headerName\":\"其他信息\"},scopedSlots:_vm._u([{key:\"content\",fn:function(){return [_c('a-row',{attrs:{\"gutter\":24}},[_c('a-col',{attrs:{\"sm\":6}},[_c('a-form-model-item',{attrs:{\"label\":\"创建人\"}},[_c('span',[_vm._v(\"admin\")])])],1),_c('a-col',{attrs:{\"sm\":6}},[_c('a-form-model-item',{attrs:{\"label\":\"修改时间\"}},[_c('span',[_vm._v(\" 2025-04-20 15:00\")])])],1)],1),_c('a-row',{attrs:{\"gutter\":24}},[_c('a-col',{attrs:{\"sm\":24}},[_c('a-form-model-item',{attrs:{\"label\":\"例外情况\"}},[_vm._l((_vm.entity.exceptions),function(item,index){return _c('div',{key:index,staticClass:\"exception-item\"},[_c('a-date-picker',{attrs:{\"placeholder\":\"选择日期\",\"value-format\":\"YYYY-MM-DD\"},model:{value:(item.date),callback:function ($$v) {_vm.$set(item, \"date\", $$v)},expression:\"item.date\"}}),_c('a-select',{staticStyle:{\"width\":\"120px\"},attrs:{\"placeholder\":\"类型\"},model:{value:(item.type),callback:function ($$v) {_vm.$set(item, \"type\", $$v)},expression:\"item.type\"}},[_c('a-select-option',{attrs:{\"value\":\"overtime\"}},[_vm._v(\"加班\")]),_c('a-select-option',{attrs:{\"value\":\"shutdown\"}},[_vm._v(\"停工\")])],1),_c('a-input',{attrs:{\"placeholder\":\"原因\"},model:{value:(item.reason),callback:function ($$v) {_vm.$set(item, \"reason\", $$v)},expression:\"item.reason\"}}),_c('a-button',{attrs:{\"type\":\"danger\",\"icon\":\"delete\"},on:{\"click\":function($event){return _vm.removeException(index)}}})],1)}),_c('a-button',{attrs:{\"type\":\"dashed\",\"icon\":\"plus\"},on:{\"click\":_vm.addException}},[_vm._v(\"添加例外情况\")])],2)],1)],1)]},proxy:true}])})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <a-spin :spinning=\"loading\">\r\n      <a-form-model\r\n        ref=\"form\"\r\n        :model=\"entity\"\r\n        :rules=\"rules\"\r\n        autocomplete=\"off\"\r\n        layout=\"vertical\"\r\n      >\r\n        <div class=\"card\">\r\n          <a-row :gutter=\"24\">\r\n            <a-col :sm=\"12\">\r\n              <a-form-model-item label=\"日期\" prop=\"date\">\r\n                <a-date-picker\r\n                  v-model=\"entity.date\"\r\n                  placeholder=\"选择日期\"\r\n                  style=\"width: 100%\"\r\n                  value-format=\"YYYY-MM-DD\"\r\n                  @change=\"dateChange\"\r\n                />\r\n              </a-form-model-item>\r\n            </a-col>\r\n            <a-col :sm=\"12\">\r\n              <a-form-model-item label=\"是否工作日\" prop=\"isWorkDay\">\r\n                <a-switch v-model=\"entity.isWorkDay\" @change=\"onWorkDayChange\" />\r\n              </a-form-model-item>\r\n            </a-col>\r\n          </a-row>\r\n  \r\n          <!-- 班次信息 -->\r\n          <a-row :gutter=\"24\" v-if=\"entity.isWorkDay\">\r\n            <a-col :sm=\"24\">\r\n              <a-form-model-item label=\"班次\">\r\n                <div v-for=\"(shift, index) in entity.shifts\" :key=\"index\" class=\"shift-item\">\r\n                  <a-time-picker\r\n                    v-model=\"shift.startTime\"\r\n                    placeholder=\"开始时间\"\r\n                    value-format=\"HH:mm\"\r\n                    @change=\"shiftTimeChange(index)\"\r\n                  />\r\n                  <a-time-picker\r\n                    v-model=\"shift.endTime\"\r\n                    placeholder=\"结束时间\"\r\n                    value-format=\"HH:mm\"\r\n                    @change=\"shiftTimeChange(index)\"\r\n  \r\n                  />\r\n                  <a-input v-model=\"shift.name\" placeholder=\"班次名称\" style=\"width:120px\"/>\r\n                  <a-button type=\"danger\" icon=\"delete\" @click=\"removeShift(index)\" />\r\n                </div>\r\n                <a-button type=\"dashed\" icon=\"plus\" @click=\"addShift\">添加班次</a-button>\r\n              </a-form-model-item>\r\n            </a-col>\r\n          </a-row>\r\n  \r\n           <!-- 停机时间 (可选) -->\r\n          <a-row :gutter=\"24\" v-if=\"!entity.isWorkDay\">\r\n              <a-col :sm=\"24\">\r\n                  <a-form-model-item label=\"停机时间\">\r\n                      <div v-for=\"(item, index) in entity.downtime\" :key=\"index\" class=\"downtime-item\">\r\n                          <a-time-picker v-model=\"item.startTime\" placeholder=\"开始时间\" value-format=\"HH:mm\" />\r\n                          <a-time-picker v-model=\"item.endTime\" placeholder=\"结束时间\" value-format=\"HH:mm\" />\r\n                          <a-input v-model=\"item.reason\" placeholder=\"原因\" style=\"width: 150px;\"/>\r\n                          <a-button type=\"danger\" icon=\"delete\" @click=\"removeDowntime(index)\" />\r\n                      </div>\r\n                      <a-button type=\"dashed\" icon=\"plus\" @click=\"addDowntime\">添加停机时间</a-button>\r\n                  </a-form-model-item>\r\n              </a-col>\r\n          </a-row>\r\n  \r\n          <!-- 备注 -->\r\n          <a-row :gutter=\"24\">\r\n            <a-col :sm=\"24\">\r\n              <a-form-model-item label=\"备注\" prop=\"remark\">\r\n                <a-textarea\r\n                  v-model=\"entity.remark\"\r\n                  placeholder=\"备注\"\r\n                  :rows=\"4\"\r\n                  :max-length=\"1000\"\r\n                />\r\n              </a-form-model-item>\r\n            </a-col>\r\n          </a-row>\r\n        </div>\r\n  \r\n        <!-- 其他信息和例外情况 -->\r\n        <g-collapse headerName=\"其他信息\">\r\n          <template #content>\r\n            <a-row :gutter=\"24\">\r\n              <a-col :sm=\"6\">\r\n                <a-form-model-item label=\"创建人\">\r\n                  <span>admin</span>\r\n                </a-form-model-item>\r\n              </a-col>\r\n              <a-col :sm=\"6\">\r\n                <a-form-model-item label=\"修改时间\">\r\n                  <span> 2025-04-20 15:00</span>\r\n                </a-form-model-item>\r\n              </a-col>\r\n            </a-row>\r\n             <!-- 例外情况 (可选) -->\r\n            <a-row :gutter=\"24\">\r\n              <a-col :sm=\"24\">\r\n                <a-form-model-item label=\"例外情况\">\r\n                  <div v-for=\"(item, index) in entity.exceptions\" :key=\"index\" class=\"exception-item\">\r\n                    <a-date-picker v-model=\"item.date\" placeholder=\"选择日期\" value-format=\"YYYY-MM-DD\"/>\r\n                    <a-select v-model=\"item.type\" placeholder=\"类型\" style=\"width: 120px\">\r\n                      <a-select-option value=\"overtime\">加班</a-select-option>\r\n                      <a-select-option value=\"shutdown\">停工</a-select-option>\r\n                    </a-select>\r\n                    <a-input v-model=\"item.reason\" placeholder=\"原因\"/>\r\n                    <a-button type=\"danger\" icon=\"delete\" @click=\"removeException(index)\"/>\r\n                  </div>\r\n                  <a-button type=\"dashed\" icon=\"plus\" @click=\"addException\">添加例外情况</a-button>\r\n                </a-form-model-item>\r\n              </a-col>\r\n            </a-row>\r\n          </template>\r\n        </g-collapse>\r\n      </a-form-model>\r\n    </a-spin>\r\n  </template>\r\n  \r\n  <script>\r\n  import { GNdoPageEditBase } from \"@/utils\";\r\n\r\n  export default {\r\n    name: \"CreateOrEditWorkCalendar\",\r\n    mixins: [GNdoPageEditBase],\r\n    data() {\r\n      return {\r\n        entity: {\r\n          date: null,\r\n          isWorkDay: true,\r\n          remark: \"\",\r\n          shifts: [], // { name: '', startTime: null, endTime: null }\r\n          downtime: [], // { startTime: null, endTime: null, reason: '' }\r\n          exceptions: [], //, { date: null, type: '', reason: '' }\r\n        },\r\n        rules: {\r\n          date: [{ required: true, message: \"请选择日期\", trigger: \"change\" }],\r\n        },\r\n        isNew: true,\r\n      };\r\n    },\r\n    watch: {\r\n      id: {\r\n        handler(newId) {\r\n          this.isNew = !newId;\r\n        },\r\n        immediate: true,\r\n      },\r\n    },\r\n    methods: {\r\n      // 初始化\r\n      async init() {\r\n        this.loading = true;\r\n        if (this.id) {\r\n          try {\r\n            const res = await getWorkCalendarById(this.id);\r\n            if (res && res.data) {\r\n              this.entity = { ...res.data }; // 使用对象扩展运算符进行深拷贝\r\n  \r\n              // 获取班次信息\r\n              if (this.entity.isWorkDay) {\r\n                const shiftRes = await getShiftsByDate(this.entity.date);\r\n                this.entity.shifts = shiftRes.data || [];\r\n              }\r\n  \r\n              // 获取停机时间\r\n              const downtimeRes = await getDowntimeByDate(this.entity.date);\r\n              this.entity.downtime = downtimeRes.data || [];\r\n  \r\n              // 获取例外情况\r\n              const exceptionRes = await getExceptionsByDate(this.entity.date);\r\n              this.entity.exceptions = exceptionRes.data || [];\r\n            } else {\r\n              this.$message.error(\"获取工作日历详情失败\");\r\n            }\r\n          } catch (error) {\r\n            console.error(\"获取工作日历详情出错:\", error);\r\n            this.$message.error(\"获取工作日历详情出错\");\r\n          } finally {\r\n            this.loading = false;\r\n          }\r\n        } else {\r\n          this.reset();\r\n          this.loading = false;\r\n        }\r\n      },\r\n      resetFormData() {\r\n        this.entity = {\r\n          date: null,\r\n          isWorkDay: true,\r\n          remark: \"\",\r\n          shifts: [],\r\n          downtime: [],\r\n          exceptions: [],\r\n        };\r\n      },\r\n      async save() {\r\n          // 保存 校验\r\n          let res = await this.checkError();\r\n          if (!res) return;\r\n  \r\n          // 班次时间校验\r\n          if(this.entity.isWorkDay){\r\n              for (let i = 0; i < this.entity.shifts.length; i++) {\r\n                  for (let j = i + 1; j < this.entity.shifts.length; j++) {\r\n                      if (\r\n                          this.entity.shifts[i].startTime < this.entity.shifts[j].endTime &&\r\n                          this.entity.shifts[j].startTime < this.entity.shifts[i].endTime\r\n                      ) {\r\n                          this.$message.error(\"班次时间不能重叠\");\r\n                          return;\r\n                      }\r\n                  }\r\n              }\r\n          }\r\n  \r\n        this.loading = true;\r\n        try {\r\n          if (this.isNew) {\r\n            const res = await createWorkCalendar(this.entity);\r\n            this.id = res.data.id // 新增成功后需要拿到id\r\n            // 创建班次、停机时间、例外情况\r\n            if(this.entity.isWorkDay){\r\n              await createShifts(this.entity.date, this.entity.shifts);\r\n            } else {\r\n              await createDowntime(this.entity.date, this.entity.downtime);\r\n            }\r\n            await createExceptions(this.entity.exceptions);\r\n  \r\n            this.$message.success(\"创建成功\");\r\n          } else {\r\n            await updateWorkCalendar(this.id, this.entity);\r\n  \r\n            // 更新班次、停机时间、例外情况\r\n            if(this.entity.isWorkDay){\r\n              await updateShifts(this.entity.date, this.entity.shifts);\r\n            } else {\r\n              await updateDowntime(this.entity.date, this.entity.downtime)\r\n            }\r\n            await updateExceptions(this.entity.exceptions);\r\n  \r\n            this.$message.success(\"更新成功\");\r\n          }\r\n          this.saveSuccess(this.entity.date);\r\n          this.handleSaveEndBackView(this.id);\r\n          this.refreshParent({\r\n            reset: null,\r\n          });\r\n        } catch (error) {\r\n          console.error(\"保存工作日历出错:\", error);\r\n          this.$message.error(\"保存失败\");\r\n        } finally {\r\n          this.loading = false;\r\n        }\r\n      },\r\n      dateChange(date, dateString) {\r\n        if (date) {\r\n          let day = new Date(date).getDay();\r\n          this.entity.isWorkDay = day !== 0 && day !== 6;\r\n          this.onWorkDayChange(this.entity.isWorkDay);\r\n        }\r\n      },\r\n      onWorkDayChange(isWorkDay) {\r\n        if (isWorkDay) {\r\n          this.entity.downtime = []; // 清空停机时间\r\n          if (this.entity.shifts.length === 0) {\r\n            this.addShift(); // 默认添加一个班次\r\n          }\r\n        } else {\r\n          this.entity.shifts = []; //清空班次\r\n        }\r\n      },\r\n      addShift() {\r\n        this.entity.shifts.push({ name: '', startTime: null, endTime: null });\r\n      },\r\n      removeShift(index) {\r\n        this.entity.shifts.splice(index, 1);\r\n      },\r\n      shiftTimeChange(index){\r\n          // 班次时间变化时的处理，例如排序\r\n          this.entity.shifts.sort((a, b) => {\r\n              if (a.startTime < b.startTime) {\r\n                  return -1;\r\n              }\r\n              if (a.startTime > b.startTime) {\r\n                  return 1;\r\n              }\r\n              return 0;\r\n          });\r\n      },\r\n      addDowntime() {\r\n        this.entity.downtime.push({ startTime: null, endTime: null, reason: '' });\r\n      },\r\n      removeDowntime(index) {\r\n        this.entity.downtime.splice(index, 1);\r\n      },\r\n      addException() {\r\n        this.entity.exceptions.push({ date: null, type: '', reason: '' });\r\n      },\r\n      removeException(index) {\r\n        this.entity.exceptions.splice(index, 1);\r\n      },\r\n    },\r\n  };\r\n  </script>\r\n  \r\n  <style lang=\"scss\" scoped>\r\n  .shift-item {\r\n    margin-bottom: 8px;\r\n    display: flex;\r\n    align-items: center;\r\n    .ant-time-picker {\r\n      margin-right: 8px;\r\n    }\r\n  }\r\n  .downtime-item{\r\n      margin-bottom: 8px;\r\n      display:flex;\r\n      align-items: center;\r\n       .ant-time-picker {\r\n      margin-right: 8px;\r\n    }\r\n  }\r\n  .exception-item {\r\n    margin-bottom: 8px;\r\n    display: flex;\r\n    align-items: center;\r\n    .ant-date-picker {\r\n      margin-right: 8px;\r\n    }\r\n    .ant-select{\r\n      margin-right: 8px;\r\n    }\r\n  }\r\n  </style>","import mod from \"-!../../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./create-or-edit-work-calendar.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./create-or-edit-work-calendar.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./create-or-edit-work-calendar.vue?vue&type=template&id=b5806b56&scoped=true\"\nimport script from \"./create-or-edit-work-calendar.vue?vue&type=script&lang=js\"\nexport * from \"./create-or-edit-work-calendar.vue?vue&type=script&lang=js\"\nimport style0 from \"./create-or-edit-work-calendar.vue?vue&type=style&index=0&id=b5806b56&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b5806b56\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","attrs","loading","ref","entity","rules","staticClass","staticStyle","on","dateChange","model","value","callback","$$v","$set","expression","onWorkDayChange","_l","shift","index","key","$event","shiftTimeChange","removeShift","addShift","_v","_e","isWorkDay","item","removeDowntime","addDowntime","scopedSlots","_u","fn","removeException","addException","proxy","staticRenderFns","name","mixins","data","date","remark","shifts","downtime","exceptions","required","message","trigger","isNew","watch","id","handler","newId","immediate","methods","init","res","getWorkCalendarById","shiftRes","getShiftsByDate","downtimeRes","getDowntimeByDate","exceptionRes","getExceptionsByDate","$message","error","console","reset","resetFormData","save","checkError","i","length","j","startTime","endTime","createWorkCalendar","createShifts","createDowntime","createExceptions","success","updateWorkCalendar","updateShifts","updateDowntime","updateExceptions","saveSuccess","handleSaveEndBackView","refreshParent","dateString","day","Date","getDay","push","splice","sort","a","b","reason","type","component"],"sourceRoot":""}