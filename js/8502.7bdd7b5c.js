"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[8502],{42570:function(e,t,a){a.d(t,{Z:function(){return c}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modal"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"sign-container"},[t("h3",{staticClass:"sign-title"},[e._v(e._s(e.title||"请在下方区域签名"))]),t("g-sign",{ref:"signBoard",attrs:{"line-width":e.lineWidth,"line-color":e.lineColor,"background-color":e.backgroundColor,"save-format":e.saveFormat},on:{save:e.handleSave,clear:e.handleClear,"save-error":e.handleError}})],1)]),t("div",{staticClass:"modal-footer"},[t("g-btn",{attrs:{text:"确认",type:"primary"},on:{callback:e.save}}),t("g-btn",{attrs:{text:"取消"},on:{callback:function(t){return e.$emit("closeModal")}}})],1)])},r=[],l=a(60704),n={name:"GSignModal",components:{GSign:l.Z},props:{title:{type:String,default:""},lineWidth:{type:Number,default:2},lineColor:{type:String,default:"#000000"},backgroundColor:{type:String,default:"#ffffff"},saveFormat:{type:String,default:"png",validator:e=>["png","jpeg","webp"].includes(e)}},data(){return{signatureData:null,hasSignature:!1}},methods:{handleSave(e){this.signatureData=e,this.hasSignature=!0},handleClear(){this.signatureData=null,this.hasSignature=!1},handleError(e){this.$message.error(e)},save(){this.hasSignature?(this.$emit("success",this.signatureData),this.$emit("closeModal")):this.$message.error("请先进行签名")},clearSignature(){this.$refs.signBoard&&this.$refs.signBoard.clearCanvas()}}},o=n,i=a(1001),u=(0,i.Z)(o,s,r,!1,null,"b8f67d68",null),c=u.exports},38502:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var s=function(){var e=this,t=e._self._c;return t("a-form-model",{ref:"form",staticClass:"h-father",attrs:{model:e.entity,layout:"vertical",autocomplete:"off",rules:e.rules}},[t("g-body-form-layout",{scopedSlots:e._u([{key:"search-card",fn:function(){return[t("div",{staticClass:"search-card"},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:4}},[t("a-form-model-item",{attrs:{label:"设备组",prop:"deviceGroupName"}},[t("g-select",{attrs:{placeholder:"请选择设备组"},model:{value:e.entity.deviceGroupName,callback:function(t){e.$set(e.entity,"deviceGroupName",t)},expression:"entity.deviceGroupName"}},e._l(e.deviceGroupOptions,(function(a){return t("a-select-option",{key:a.value,attrs:{value:a.value}},[e._v(e._s(a.label))])})),1)],1)],1),t("a-col",{attrs:{span:4}},[t("a-form-model-item",{attrs:{label:"设备",prop:"deviceName"}},[t("g-select",{attrs:{placeholder:"请选择设备"},model:{value:e.entity.deviceName,callback:function(t){e.$set(e.entity,"deviceName",t)},expression:"entity.deviceName"}},e._l(e.deviceOptions,(function(a){return t("a-select-option",{key:a.value,attrs:{value:a.value}},[e._v(e._s(a.label))])})),1)],1)],1),t("a-col",{attrs:{span:8}}),t("a-col",{attrs:{span:4}},[t("div",{staticStyle:{display:"flex","justify-content":"flex-end","align-items":"center",height:"100%"}},[t("g-btn-group",{attrs:{buttonLists:e.btnList},on:{btnCallback:function(t){return e.btnCallback(t)}}})],1)])],1)],1)]},proxy:!0},{key:"expand-card",fn:function(){return[t("div",{staticClass:"expand-card"},[t("g-collapse",{attrs:{headerName:"状态切换配置"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:6}},[t("a-form-model-item",{attrs:{label:"当前状态",prop:"currentStatus"}},[t("a-select",{attrs:{placeholder:"请选择当前状态",disabled:""},model:{value:e.entity.currentStatus,callback:function(t){e.$set(e.entity,"currentStatus",t)},expression:"entity.currentStatus"}},e._l(e.statusOptions,(function(a){return t("a-select-option",{key:a.value,attrs:{value:a.value}},[e._v(e._s(a.label))])})),1)],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-model-item",{attrs:{label:"目标状态",prop:"targetStatus"}},[t("a-select",{attrs:{placeholder:"请选择目标状态"},on:{change:e.handleStatusChange},model:{value:e.entity.targetStatus,callback:function(t){e.$set(e.entity,"targetStatus",t)},expression:"entity.targetStatus"}},e._l(e.statusOptions,(function(a){return t("a-select-option",{key:a.value,attrs:{value:a.value}},[e._v(e._s(a.label))])})),1)],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-model-item",{attrs:{label:"切换原因",prop:"reason",rules:e.reasonRules}},[t("a-select",{attrs:{placeholder:"请选择切换原因"},model:{value:e.entity.reason,callback:function(t){e.$set(e.entity,"reason",t)},expression:"entity.reason"}},[t("a-select-option",{attrs:{value:"计划内"}},[e._v("计划内")]),t("a-select-option",{attrs:{value:"计划外"}},[e._v("计划外")]),t("a-select-option",{attrs:{value:"故障"}},[e._v("故障")]),t("a-select-option",{attrs:{value:"其他"}},[e._v("其他")])],1)],1)],1),t("a-col",{attrs:{span:6}},["故障"===e.entity.reason?t("a-form-model-item",{attrs:{label:"故障代码",prop:"faultCode"}},[t("a-input",{attrs:{placeholder:"请输入故障代码"},model:{value:e.entity.faultCode,callback:function(t){e.$set(e.entity,"faultCode",t)},expression:"entity.faultCode"}})],1):e._e()],1)],1)]},proxy:!0}])})],1)]},proxy:!0},{key:"card-body",fn:function(){return[t("g-collapse",{attrs:{headerName:"设备信息"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"设备类型",prop:"deviceType"}},[t("a-select",{attrs:{placeholder:"请选择设备类型",disabled:""},model:{value:e.entity.deviceType,callback:function(t){e.$set(e.entity,"deviceType",t)},expression:"entity.deviceType"}},[t("a-select-option",{attrs:{value:"温度传感器"}},[e._v("温度传感器")]),t("a-select-option",{attrs:{value:"湿度传感器"}},[e._v("湿度传感器")]),t("a-select-option",{attrs:{value:"压力传感器"}},[e._v("压力传感器")]),t("a-select-option",{attrs:{value:"振动传感器"}},[e._v("振动传感器")]),t("a-select-option",{attrs:{value:"位移传感器"}},[e._v("位移传感器")])],1)],1)],1)],1)]},proxy:!0}])}),t("g-collapse",{attrs:{headerName:"操作描述"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"备注",prop:"remark"}},[t("a-textarea",{attrs:{placeholder:"请输入备注信息",rows:4},model:{value:e.entity.remark,callback:function(t){e.$set(e.entity,"remark",t)},expression:"entity.remark"}})],1)],1)],1)]},proxy:!0}])})]},proxy:!0},{key:"g-fixed-row",fn:function(){return[t("div",{staticClass:"g-fixed-row"},[t("g-btn",{attrs:{size:"large",text:"刷新"},on:{callback:function(t){return e.refresh()}}}),t("g-btn",{attrs:{size:"large",text:"提交",type:"primary"},on:{callback:function(t){return e.submitStatusChange()}}})],1)]},proxy:!0}])})],1)},r=[],l=a(42570),n=a(36026),o=a(58805),i={name:"DeviceStatusChange",data(){return{entity:{deviceGroupName:"",deviceName:"",currentStatus:"待机",targetStatus:"",reason:"",faultCode:"",remark:"",deviceType:""},rules:{deviceName:[{required:!0,message:"请选择设备",trigger:"change"}],deviceGroupName:[{required:!0,message:"请选择设备组",trigger:"change"}],targetStatus:[{required:!0,message:"请选择目标状态",trigger:"change"}],reason:[{required:!0,message:"请选择切换原因",trigger:"change"}]},reasonRules:[{required:!0,message:"请选择切换原因",trigger:"change"}],statusOptions:[{value:"运行",label:"运行"},{value:"待机",label:"待机"},{value:"故障",label:"故障"},{value:"维护",label:"维护"},{value:"离线",label:"离线"},{value:"设置",label:"设置"},{value:"测试",label:"测试"},{value:"清洁",label:"清洁"},{value:"换型",label:"换型"}],deviceGroupOptions:[],deviceOptions:[],btnList:[{icon:o.Z.icon.documentShow,text:o.Z.button.documentShow,eventName:o.Z.button.documentShow,display:!0}]}},watch:{"entity.deviceGroupName":{handler(e){e?this.loadDeviceOptions(e):this.deviceOptions=[]}}},mounted(){this.loadDeviceGroupOptions(),this.deviceGroupOptions.length>0&&(this.entity.deviceGroupName=this.deviceGroupOptions[0].value)},methods:{submitStatusChange(){this.$refs.form.validate().then((e=>{e&&this.createSignModal()}))},createSignModal(){(0,n.f7)({title:"签名",width:"600px"},{component:l.Z,success:e=>{console.log(e),console.log("提交设备状态切换:",this.entity),this.$message.success("设备状态切换提交成功"),this.refresh()}})},refresh(){this.$refs.form.resetFields(),this.entity.currentStatus="待机",this.deviceGroupOptions.length>0&&(this.entity.deviceGroupName=this.deviceGroupOptions[0].value)},handleStatusChange(e){"故障"!==e&&"故障"!==this.entity.currentStatus||(this.entity.faultCode="")},loadDeviceGroupOptions(){setTimeout((()=>{this.deviceGroupOptions=[{value:"group1",label:"设备组1"},{value:"group2",label:"设备组2"},{value:"group3",label:"设备组3"}]}),500)},loadDeviceOptions(e){console.log("选择的设备组:",e),setTimeout((()=>{this.deviceOptions="group1"===e?[{value:"device1",label:"设备1"},{value:"device2",label:"设备2"}]:"group2"===e?[{value:"device3",label:"设备3"},{value:"device4",label:"设备4"}]:[]}),500)},btnCallback(e){console.log(e)}}},u=i,c=a(1001),d=(0,c.Z)(u,s,r,!1,null,null,null),p=d.exports}}]);
//# sourceMappingURL=8502.7bdd7b5c.js.map