"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[3940],{42570:function(e,t,a){a.d(t,{Z:function(){return c}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modal"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"sign-container"},[t("h3",{staticClass:"sign-title"},[e._v(e._s(e.title||"请在下方区域签名"))]),t("g-sign",{ref:"signBoard",attrs:{"line-width":e.lineWidth,"line-color":e.lineColor,"background-color":e.backgroundColor,"save-format":e.saveFormat},on:{save:e.handleSave,clear:e.handleClear,"save-error":e.handleError}})],1)]),t("div",{staticClass:"modal-footer"},[t("g-btn",{attrs:{text:"确认",type:"primary"},on:{callback:e.save}}),t("g-btn",{attrs:{text:"取消"},on:{callback:function(t){return e.$emit("closeModal")}}})],1)])},n=[],s=a(60704),i={name:"GSignModal",components:{GSign:s.Z},props:{title:{type:String,default:""},lineWidth:{type:Number,default:2},lineColor:{type:String,default:"#000000"},backgroundColor:{type:String,default:"#ffffff"},saveFormat:{type:String,default:"png",validator:e=>["png","jpeg","webp"].includes(e)}},data(){return{signatureData:null,hasSignature:!1}},methods:{handleSave(e){this.signatureData=e,this.hasSignature=!0},handleClear(){this.signatureData=null,this.hasSignature=!1},handleError(e){this.$message.error(e)},save(){this.hasSignature?(this.$emit("success",this.signatureData),this.$emit("closeModal")):this.$message.error("请先进行签名")},clearSignature(){this.$refs.signBoard&&this.$refs.signBoard.clearCanvas()}}},o=i,l=a(1001),d=(0,l.Z)(o,r,n,!1,null,"b8f67d68",null),c=d.exports},93940:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var r=function(){var e=this,t=e._self._c;return t("a-form-model",{ref:"form",staticClass:"h-father",attrs:{model:e.entity,layout:"vertical",autocomplete:"off",rules:e.rules}},[t("g-body-form-layout",{scopedSlots:e._u([{key:"search-card",fn:function(){return[t("div",{staticClass:"search-card"},[t("g-container-list",{attrs:{value:e.entity.containerName},on:{"update:value":function(t){return e.$set(e.entity,"containerName",t)}}})],1)]},proxy:!0},{key:"expand-card",fn:function(){return[t("div",{staticClass:"expand-card"},[t("g-collapse",{attrs:{headerName:"批次信息"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:6}},[t("a-form-model-item",{attrs:{label:"批次编号"}},[t("a-input",{attrs:{disabled:""},model:{value:e.entity.batchNo,callback:function(t){e.$set(e.entity,"batchNo",t)},expression:"entity.batchNo"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-model-item",{attrs:{label:"物料编码"}},[t("a-input",{attrs:{disabled:""},model:{value:e.entity.materialCode,callback:function(t){e.$set(e.entity,"materialCode",t)},expression:"entity.materialCode"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-model-item",{attrs:{label:"物料名称"}},[t("a-input",{attrs:{disabled:""},model:{value:e.entity.materialName,callback:function(t){e.$set(e.entity,"materialName",t)},expression:"entity.materialName"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-model-item",{attrs:{label:"当前状态"}},[t("a-input",{attrs:{disabled:""},model:{value:e.entity.currentStatus,callback:function(t){e.$set(e.entity,"currentStatus",t)},expression:"entity.currentStatus"}})],1)],1)],1)]},proxy:!0}])})],1)]},proxy:!0},{key:"card-body",fn:function(){return[t("g-collapse",{attrs:{headerName:"操作类型"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:6}},[t("a-form-model-item",{attrs:{label:"操作类型",prop:"operationType",rules:[{required:!0,message:"请选择操作类型"}]}},[t("a-radio-group",{on:{change:e.operationTypeChange},model:{value:e.entity.operationType,callback:function(t){e.$set(e.entity,"operationType",t)},expression:"entity.operationType"}},[t("a-radio",{attrs:{value:"hold"}},[e._v("搁置")]),t("a-radio",{attrs:{value:"release"}},[e._v("释放")])],1)],1)],1),"hold"===e.entity.operationType?t("a-col",{attrs:{span:6}},[t("a-form-model-item",{attrs:{label:"搁置原因",prop:"reasonId",rules:[{required:!0,message:"请选择搁置原因"}]}},[t("a-select",{attrs:{placeholder:"请选择搁置原因"},model:{value:e.entity.reasonId,callback:function(t){e.$set(e.entity,"reasonId",t)},expression:"entity.reasonId"}},e._l(e.holdReasons,(function(a){return t("a-select-option",{key:a.id,attrs:{value:a.id}},[e._v(" "+e._s(a.name)+" ")])})),1)],1)],1):e._e(),"release"===e.entity.operationType?t("a-col",{attrs:{span:6}},[t("a-form-model-item",{attrs:{label:"释放原因",prop:"reasonId",rules:[{required:!0,message:"请选择释放原因"}]}},[t("a-select",{attrs:{placeholder:"请选择释放原因"},model:{value:e.entity.reasonId,callback:function(t){e.$set(e.entity,"reasonId",t)},expression:"entity.reasonId"}},e._l(e.releaseReasons,(function(a){return t("a-select-option",{key:a.id,attrs:{value:a.id}},[e._v(" "+e._s(a.name)+" ")])})),1)],1)],1):e._e()],1)]},proxy:!0}])}),t("g-collapse",{attrs:{headerName:"数据采集"},scopedSlots:e._u([{key:"content",fn:function(){return[t("g-data-points",{attrs:{dataPoints:e.entity.dataPoints,validDataName:"dataPoints"}})]},proxy:!0}])}),t("g-collapse",{attrs:{headerName:"操作说明"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"操作说明",prop:"description",rules:[{required:!0,message:"请输入操作说明"}]}},[t("a-textarea",{attrs:{rows:"4",placeholder:"请输入操作说明","max-length":1e3},model:{value:e.entity.description,callback:function(t){e.$set(e.entity,"description",t)},expression:"entity.description"}})],1)],1)],1)]},proxy:!0}])})]},proxy:!0},{key:"g-fixed-row",fn:function(){return[t("div",{staticClass:"g-fixed-row"},[t("g-btn",{attrs:{size:"large",text:"刷新"},on:{callback:function(t){return e.refresh()}}}),t("g-btn",{attrs:{size:"large",text:"提交",type:"primary"},on:{callback:function(t){return e.submitOperation()}}})],1)]},proxy:!0}])})],1)},n=[],s=a(42570),i=a(36026),o={name:"DataV2HoldRelease",data(){return{entity:{containerName:"",batchNo:"",materialCode:"",materialName:"",currentStatus:"",operationType:"hold",reasonId:"",description:"",dataPoints:[{dataValue:"",dataPointName:"操作人员",isRequired:!0,dataType:"String"},{dataValue:"",dataPointName:"操作时间",isRequired:!0,dataType:"Timestamp"}]},rules:{containerName:[{required:!0,message:"请选择批次",trigger:"change"}],operationType:[{required:!0,message:"请选择操作类型",trigger:"change"}],reasonId:[{required:!0,message:"请选择原因",trigger:"change"}],description:[{required:!0,message:"请输入操作说明",trigger:"blur"}]},holdReasons:[{id:"1",name:"质量问题"},{id:"2",name:"设备故障"},{id:"3",name:"待检验"},{id:"4",name:"其他原因"}],releaseReasons:[{id:"1",name:"检验合格"},{id:"2",name:"问题解决"},{id:"3",name:"特殊放行"},{id:"4",name:"其他原因"}]}},watch:{"entity.containerName":{handler(){this.$refs.form&&this.$refs.form.validateField("containerName"),this.entity.containerName&&this.fetchBatchInfo()}}},mounted(){},methods:{fetchBatchInfo(){setTimeout((()=>{this.entity.batchNo="B"+Math.floor(1e4*Math.random()),this.entity.materialCode="M"+Math.floor(1e4*Math.random()),this.entity.materialName="测试物料",this.entity.currentStatus="在库"}),500)},operationTypeChange(){this.entity.reasonId=""},submitOperation(){this.$refs.form.validate().then((e=>{e&&this.createSignModal()}))},createSignModal(){(0,i.f7)({title:"签名确认",width:"600px"},{component:s.Z,success:e=>{console.log("签名信息:",e),this.saveOperation()}})},saveOperation(){const e="hold"===this.entity.operationType?"搁置":"释放";this.$message.success(`批次${e}操作成功`),this.refresh()},refresh(){this.entity={containerName:"",batchNo:"",materialCode:"",materialName:"",currentStatus:"",operationType:"hold",reasonId:"",description:"",dataPoints:[{dataValue:"",dataPointName:"操作人员",isRequired:!0,dataType:"String"},{dataValue:"",dataPointName:"操作时间",isRequired:!0,dataType:"Timestamp"}]}}}},l=o,d=a(1001),c=(0,d.Z)(l,r,n,!1,null,"2493629a",null),u=c.exports}}]);
//# sourceMappingURL=3940.24bc593e.js.map