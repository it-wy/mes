"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[9090],{59090:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{height:"100%","background-color":"#fff",padding:"14px",display:"flex"}},[t("div",{staticStyle:{width:"23%",display:"flex","flex-direction":"column","border-right":"1px solid #e8e8e8"}},[t("div",{staticStyle:{color:"white"}},[t("a-input-search",{staticStyle:{width:"80%"},attrs:{placeholder:"搜索名称"},on:{search:e.onSearch},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),t("div",{staticClass:"tree"},[t("a-tree",{attrs:{"tree-data":e.treeData,expandedKeys:e.expandedKeys},on:{"update:expandedKeys":function(t){e.expandedKeys=t},"update:expanded-keys":function(t){e.expandedKeys=t}},scopedSlots:e._u([{key:"title",fn:function({key:a,title:r}){return[t("div",{staticClass:"tree-node-content"},[t("span",[e._v(e._s(r))]),t("div",{staticClass:"operation-buttons"},[t("a-button",{attrs:{type:"link",size:"small"},on:{click:function(t){return t.stopPropagation(),e.handleAdd(a)}}},[t("a-icon",{attrs:{type:"plus"}})],1),t("a-button",{attrs:{type:"link",size:"small"},on:{click:function(t){return t.stopPropagation(),e.handleEdit(a)}}},[t("a-icon",{attrs:{type:"edit"}})],1),t("a-button",{attrs:{type:"link",size:"small"},on:{click:function(t){return t.stopPropagation(),e.handleDelete(a)}}},[t("a-icon",{attrs:{type:"delete"}})],1)],1)])]}}])})],1)]),t("div",{staticStyle:{flex:"1",height:"100%","overflow-y":"auto","overflow-x":"hidden",padding:"0 20px","box-sizing":"border-box"}},[t("div",[t("div",{staticStyle:{"margin-bottom":"10px","background-color":"#fff",display:"flex","justify-content":"space-between","align-items":"center",position:"sticky",top:"0","z-index":"2"}},[t("span",{staticStyle:{"font-size":"20px","font-weight":"bold"}},[e._v("新菜单")]),t("a-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("保存")])],1),t("a-form",{attrs:{"label-col":{span:6},layout:"horizontal","wrapper-col":{span:16}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"菜单名称",required:!0}},[t("a-input",{attrs:{placeholder:"请输入菜单名称"},model:{value:e.formData.menuName,callback:function(t){e.$set(e.formData,"menuName",t)},expression:"formData.menuName"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"上级菜单"}},[t("a-select",{attrs:{placeholder:"请选择上级菜单"},model:{value:e.formData.parentMenu,callback:function(t){e.$set(e.formData,"parentMenu",t)},expression:"formData.parentMenu"}},[t("a-select-option",{attrs:{value:"权限管理"}},[e._v("权限管理")])],1)],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"菜单图标"}},[t("a-input-search",{attrs:{placeholder:"点击后面按钮选择图标"},model:{value:e.formData.menuIcon,callback:function(t){e.$set(e.formData,"menuIcon",t)},expression:"formData.menuIcon"}},[t("a-button",{attrs:{slot:"enterButton",type:"primary"},on:{click:e.handleSelectIcon},slot:"enterButton"},[e._v("选择图标")])],1)],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"菜单类型",required:!0}},[t("a-radio-group",{model:{value:e.formData.menuType,callback:function(t){e.$set(e.formData,"menuType",t)},expression:"formData.menuType"}},[t("a-radio-button",{attrs:{value:"menu"}},[e._v("菜单")]),t("a-radio-button",{attrs:{value:"button"}},[e._v("按钮")]),t("a-radio-button",{attrs:{value:"external"}},[e._v("外链")]),t("a-radio-button",{attrs:{value:"iframe"}},[e._v("Iframe")])],1)],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"路由地址",required:!0}},[t("a-input",{attrs:{placeholder:"页面访问地址，以 '/' 开头"},model:{value:e.formData.routePath,callback:function(t){e.$set(e.formData,"routePath",t)},expression:"formData.routePath"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"路由重定向"}},[t("a-input",{attrs:{placeholder:"利用 vue-router 跳转其他路由地址，以 '/' 开头"},model:{value:e.formData.redirectPath,callback:function(t){e.$set(e.formData,"redirectPath",t)},expression:"formData.redirectPath"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:24}},[t("a-form-item",{attrs:{label:"视图地址","label-col":{span:3},"wrapper-col":{span:20}}},[t("a-input",{attrs:{placeholder:"视图地址，请指向模块或插件下的views目录文件"},model:{value:e.formData.viewPath,callback:function(t){e.$set(e.formData,"viewPath",t)},expression:"formData.viewPath"}},[t("template",{slot:"addonBefore"},[t("a-select",{staticStyle:{width:"120px"},model:{value:e.formData.viewPathPrefix,callback:function(t){e.$set(e.formData,"viewPathPrefix",t)},expression:"formData.viewPathPrefix"}},[t("a-select-option",{attrs:{value:"src/modules/"}},[e._v("src/modules/")])],1)],1),t("template",{slot:"addonAfter"},[t("a-select",{staticStyle:{width:"80px"},model:{value:e.formData.viewPathSuffix,callback:function(t){e.$set(e.formData,"viewPathSuffix",t)},expression:"formData.viewPathSuffix"}},[t("a-select-option",{attrs:{value:".vue"}},[e._v(".vue")])],1)],1)],2)],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"国际化"}},[t("a-input",{attrs:{placeholder:"菜单标题国际化"},model:{value:e.formData.i18nKey,callback:function(t){e.$set(e.formData,"i18nKey",t)},expression:"formData.i18nKey"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"排序"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:0},model:{value:e.formData.sortOrder,callback:function(t){e.$set(e.formData,"sortOrder",t)},expression:"formData.sortOrder"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:8}},[t("a-form-item",{attrs:{label:"是否启用","wrapper-col":{span:10}}},[t("a-switch",{model:{value:e.formData.isEnabled,callback:function(t){e.$set(e.formData,"isEnabled",t)},expression:"formData.isEnabled"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-item",{attrs:{label:"是否隐藏","wrapper-col":{span:10}}},[t("a-switch",{model:{value:e.formData.isHidden,callback:function(t){e.$set(e.formData,"isHidden",t)},expression:"formData.isHidden"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-item",{attrs:{label:"是否缓存","wrapper-col":{span:10}}},[t("a-switch",{attrs:{checked:!0},model:{value:e.formData.isCached,callback:function(t){e.$set(e.formData,"isCached",t)},expression:"formData.isCached"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:8}},[t("a-form-item",{attrs:{label:"版权显示","wrapper-col":{span:10}}},[t("a-switch",{model:{value:e.formData.showCopyright,callback:function(t){e.$set(e.formData,"showCopyright",t)},expression:"formData.showCopyright"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-item",{attrs:{label:"面包屑显示","wrapper-col":{span:10}}},[t("a-switch",{attrs:{checked:!0},model:{value:e.formData.showBreadcrumb,callback:function(t){e.$set(e.formData,"showBreadcrumb",t)},expression:"formData.showBreadcrumb"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-item",{attrs:{label:"Tab是否固定","wrapper-col":{span:10}}},[t("a-switch",{model:{value:e.formData.isTabFixed,callback:function(t){e.$set(e.formData,"isTabFixed",t)},expression:"formData.isTabFixed"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:24}},[t("a-form-item",{attrs:{label:"备注","label-col":{span:3},"wrapper-col":{span:20}}},[t("a-textarea",{attrs:{rows:4,"max-length":255},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1)],1)],1),"menu"===e.formData.menuType?t("a-row",[t("a-col",{attrs:{span:24}},[t("a-form-item",{attrs:{label:"按钮权限","label-col":{span:3},"wrapper-col":{span:21}}},[t("a-table",{attrs:{columns:e.buttonColumns,"data-source":e.formData.buttons,pagination:!1,bordered:""},scopedSlots:e._u([{key:"name",fn:function(a,r,o){return[t("a-input",{attrs:{placeholder:"按钮名称"},model:{value:r.name,callback:function(t){e.$set(r,"name",t)},expression:"record.name"}})]}},{key:"identifier",fn:function(a,r,o){return[t("a-input",{attrs:{placeholder:"按钮标识"},model:{value:r.identifier,callback:function(t){e.$set(r,"identifier",t)},expression:"record.identifier"}})]}},{key:"i18n",fn:function(a,r,o){return[t("a-input",{attrs:{placeholder:"按钮国际化"},model:{value:r.i18n,callback:function(t){e.$set(r,"i18n",t)},expression:"record.i18n"}})]}},{key:"operation",fn:function(a,r,o){return[t("a-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.removeButton(o)}}},[e._v("删除")])]}}],null,!1,1558445397)}),t("a-button",{attrs:{type:"dashed",block:""},on:{click:e.addButton}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 新增一个 ")],1)],1)],1)],1):e._e()],1)],1)])])},o=[],n=a(58430),s={components:{DatabaseOutlined:n.DatabaseOutlined,PaperClipOutlined:n.PaperClipOutlined,ClockCircleOutlined:n.ClockCircleOutlined,LockOutlined:n.LockOutlined},data(){return{collapsed:!1,selectedKeys:["data-center"],expandedKeys:["attachment-management","log-management","permission-management"],searchValue:"",expandAllByDefault:!0,formData:{menuName:"",parentMenu:"权限管理",menuIcon:"",menuType:"menu",routePath:"",viewPath:"",viewPathPrefix:"src/modules/",viewPathSuffix:".vue",redirectPath:"",i18nKey:"",isEnabled:!0,isHidden:!1,isCached:!0,showCopyright:!1,showBreadcrumb:!0,isTabFixed:!1,sortOrder:0,remark:"",buttons:[]},buttonColumns:[{title:"按钮名称",dataIndex:"name",scopedSlots:{customRender:"name"}},{title:"按钮标识",dataIndex:"identifier",scopedSlots:{customRender:"identifier"}},{title:"按钮国际化",dataIndex:"i18n",scopedSlots:{customRender:"i18n"}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],mockMenuData:{menu:{menuName:"新建菜单",parentMenu:"",menuIcon:"dashboard",menuType:"menu",routePath:"/demo",viewPath:"views/demo",viewPathPrefix:"src/modules/",viewPathSuffix:".vue",redirectPath:"",i18nKey:"menu.demo",isEnabled:!0,isHidden:!1,isCached:!0,showCopyright:!0,showBreadcrumb:!0,isTabFixed:!1,sortOrder:0,remark:"这是一个示例菜单"}}}},computed:{treeData(){const e=this.$store.state.routers;return this.transformRoutesToTree(e)}},methods:{handleTreeSelect(e,t){console.log("selected",e,t),t.selected&&this.$router.push({name:t.node.dataRef.key})},addButton(){this.formData.buttons.push({name:"",identifier:"",i18n:""})},removeButton(e){this.formData.buttons.splice(e,1)},handleSelectIcon(){console.log("Open icon selection modal")},handleClearIcon(){this.formData.menuIcon=""},handleSubmit(){console.log("Form data:",this.formData),alert("Form Submitted, check console")},onSearch(e){console.log("Search value: ",e),this.treeData=this.treeData.filter((t=>t.title.indexOf(e)>-1))},expandAllNodes(){this.expandAllByDefault=!0,this.expandedKeys=this.getAllKeys(this.treeData)},collapseAllNodes(){this.expandAllByDefault=!1,this.expandedKeys=[]},getAllKeys(e){let t=[];for(const a of e)t.push(a.key),a.children&&(t=t.concat(this.getAllKeys(a.children)));return t},transformRoutesToTree(e){return e.map((e=>{const t={title:e.meta?.title||e.name,key:e.path};return e.children&&e.children.length&&(t.children=this.transformRoutesToTree(e.children)),t}))},handleAdd(e){const t=this.findNodeByKey(this.treeData,e),a={title:"新建菜单",key:`${e}/new-${Date.now()}`,children:[]};t.children||this.$set(t,"children",[]),t.children.push(a),this.expandedKeys.includes(e)||this.expandedKeys.push(e),this.$message.success("添加成功")},handleEdit(e){const t=this.findNodeByKey(this.treeData,e),a={...this.mockMenuData.menu};a.menuName=t.title,a.routePath=t.key,this.formData=a,this.$message.success("已加载菜单数据")},handleDelete(e){this.$confirm({title:"确认删除",content:"确定要删除此菜单吗？此操作将同时删除其下所有子菜单。",okText:"确认",cancelText:"取消",onOk:()=>{this.deleteNodeByKey(this.treeData,e),this.$message.success("删除成功"),this.formData={menuName:"",parentMenu:"权限管理",menuIcon:"",menuType:"menu",routePath:"",viewPath:"",viewPathPrefix:"src/modules/",viewPathSuffix:".vue",redirectPath:"",i18nKey:"",isEnabled:!0,isHidden:!1,isCached:!0,showCopyright:!1,showBreadcrumb:!0,isTabFixed:!1,sortOrder:0,remark:"",buttons:[]}}})},findNodeByKey(e,t){for(let a of e){if(a.key===t)return a;if(a.children){const e=this.findNodeByKey(a.children,t);if(e)return e}}return null},deleteNodeByKey(e,t,a=null){for(let r=0;r<e.length;r++){const a=e[r];if(a.key===t)return e.splice(r,1),!0;if(a.children){const e=this.deleteNodeByKey(a.children,t,a);if(e)return 0===a.children.length&&this.$delete(a,"children"),!0}}return!1},generateRoutePath(e,t){const a=t.toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]/g,"");return`${e}/${a}-${Date.now()}`}}},l=s,i=a(1001),c=(0,i.Z)(l,r,o,!1,null,"5e121975",null),d=c.exports}}]);
//# sourceMappingURL=9090.1f9faaab.js.map