"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[5133],{42570:function(e,t,a){a.d(t,{Z:function(){return u}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modal"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"sign-container"},[t("h3",{staticClass:"sign-title"},[e._v(e._s(e.title||"请在下方区域签名"))]),t("g-sign",{ref:"signBoard",attrs:{"line-width":e.lineWidth,"line-color":e.lineColor,"background-color":e.backgroundColor,"save-format":e.saveFormat},on:{save:e.handleSave,clear:e.handleClear,"save-error":e.handleError}})],1)]),t("div",{staticClass:"modal-footer"},[t("g-btn",{attrs:{text:"确认",type:"primary"},on:{callback:e.save}}),t("g-btn",{attrs:{text:"取消"},on:{callback:function(t){return e.$emit("closeModal")}}})],1)])},i=[],r=a(60704),s={name:"GSignModal",components:{GSign:r.Z},props:{title:{type:String,default:""},lineWidth:{type:Number,default:2},lineColor:{type:String,default:"#000000"},backgroundColor:{type:String,default:"#ffffff"},saveFormat:{type:String,default:"png",validator:e=>["png","jpeg","webp"].includes(e)}},data(){return{signatureData:null,hasSignature:!1}},methods:{handleSave(e){this.signatureData=e,this.hasSignature=!0},handleClear(){this.signatureData=null,this.hasSignature=!1},handleError(e){this.$message.error(e)},save(){this.hasSignature?(this.$emit("success",this.signatureData),this.$emit("closeModal")):this.$message.error("请先进行签名")},clearSignature(){this.$refs.signBoard&&this.$refs.signBoard.clearCanvas()}}},o=s,n=a(1001),c=(0,n.Z)(o,l,i,!1,null,"b8f67d68",null),u=c.exports},55133:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var l=function(){var e=this,t=e._self._c;return t("a-form-model",{ref:"form",staticClass:"h-father",attrs:{model:e.entity,layout:"vertical",autocomplete:"off",rules:e.rules}},[t("g-body-form-layout",{scopedSlots:e._u([{key:"search-card",fn:function(){return[t("div",{staticClass:"search-card"},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:4}},[t("a-form-model-item",{attrs:{label:"设备组",prop:"deviceGroupName"}},[t("g-select",{attrs:{placeholder:"请选择设备组"},model:{value:e.entity.deviceGroupName,callback:function(t){e.$set(e.entity,"deviceGroupName",t)},expression:"entity.deviceGroupName"}},e._l(e.deviceGroupOptions,(function(a){return t("a-select-option",{key:a.value,attrs:{value:a.value}},[e._v(e._s(a.label))])})),1)],1)],1),t("a-col",{attrs:{span:4}},[t("a-form-model-item",{attrs:{label:"设备",prop:"deviceName"}},[t("g-select",{attrs:{placeholder:"请选择设备"},model:{value:e.entity.deviceName,callback:function(t){e.$set(e.entity,"deviceName",t)},expression:"entity.deviceName"}},e._l(e.deviceOptions,(function(a){return t("a-select-option",{key:a.value,attrs:{value:a.value}},[e._v(e._s(a.label))])})),1)],1)],1)],1)],1)]},proxy:!0},{key:"card-body",fn:function(){return[t("g-collapse",{attrs:{headerName:"故障信息"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:6}},[t("a-form-model-item",{attrs:{label:"故障类型",prop:"faultType"}},[t("a-select",{attrs:{placeholder:"请选择故障类型"},model:{value:e.entity.faultType,callback:function(t){e.$set(e.entity,"faultType",t)},expression:"entity.faultType"}},e._l(e.faultTypeOptions,(function(a){return t("a-select-option",{key:a.value,attrs:{value:a.value}},[e._v(e._s(a.label))])})),1)],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-model-item",{attrs:{label:"故障等级",prop:"faultLevel"}},[t("a-select",{attrs:{placeholder:"请选择故障等级"},model:{value:e.entity.faultLevel,callback:function(t){e.$set(e.entity,"faultLevel",t)},expression:"entity.faultLevel"}},e._l(e.faultLevelOptions,(function(a){return t("a-select-option",{key:a.value,attrs:{value:a.value}},[e._v(e._s(a.label))])})),1)],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-model-item",{attrs:{label:"发现时间",prop:"discoveryTime"}},[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{"show-time":"",format:"YYYY-MM-DD HH:mm:ss"},model:{value:e.entity.discoveryTime,callback:function(t){e.$set(e.entity,"discoveryTime",t)},expression:"entity.discoveryTime"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"故障现象",prop:"faultDescription"}},[t("a-textarea",{attrs:{placeholder:"请详细描述故障现象",rows:4},model:{value:e.entity.faultDescription,callback:function(t){e.$set(e.entity,"faultDescription",t)},expression:"entity.faultDescription"}})],1)],1)],1)]},proxy:!0}])}),t("g-collapse",{attrs:{headerName:"影响评估"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"影响范围",prop:"impactScope"}},[t("a-select",{attrs:{placeholder:"请选择影响范围",mode:"multiple"},model:{value:e.entity.impactScope,callback:function(t){e.$set(e.entity,"impactScope",t)},expression:"entity.impactScope"}},[t("a-select-option",{attrs:{value:"生产线"}},[e._v("生产线")]),t("a-select-option",{attrs:{value:"工作站"}},[e._v("工作站")]),t("a-select-option",{attrs:{value:"质量检测"}},[e._v("质量检测")]),t("a-select-option",{attrs:{value:"物料配送"}},[e._v("物料配送")])],1)],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"预计修复时间",prop:"estimatedRepairTime"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:.5,step:.5,placeholder:"请输入预计修复时间(小时)"},model:{value:e.entity.estimatedRepairTime,callback:function(t){e.$set(e.entity,"estimatedRepairTime",t)},expression:"entity.estimatedRepairTime"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"影响描述",prop:"impactDescription"}},[t("a-textarea",{attrs:{placeholder:"请描述故障造成的影响",rows:3},model:{value:e.entity.impactDescription,callback:function(t){e.$set(e.entity,"impactDescription",t)},expression:"entity.impactDescription"}})],1)],1)],1)]},proxy:!0}])})]},proxy:!0},{key:"g-fixed-row",fn:function(){return[t("div",{staticClass:"g-fixed-row"},[t("g-btn",{attrs:{size:"large",text:"刷新"},on:{callback:function(t){return e.refresh()}}}),t("g-btn",{attrs:{size:"large",text:"提交",type:"primary"},on:{callback:function(t){return e.submitFaultReport()}}})],1)]},proxy:!0}])})],1)},i=[],r=a(42570),s=a(36026),o={name:"DeviceFaultReport",data(){return{entity:{deviceGroupName:"",deviceName:"",faultType:void 0,faultLevel:void 0,discoveryTime:null,faultDescription:"",impactScope:[],estimatedRepairTime:1,impactDescription:""},rules:{deviceGroupName:[{required:!0,message:"请选择设备组",trigger:"change"}],deviceName:[{required:!0,message:"请选择设备",trigger:"change"}],faultType:[{required:!0,message:"请选择故障类型",trigger:"change"}],faultLevel:[{required:!0,message:"请选择故障等级",trigger:"change"}],discoveryTime:[{required:!0,message:"请选择发现时间",trigger:"change"}],faultDescription:[{required:!0,message:"请描述故障现象",trigger:"blur"}],impactScope:[{required:!0,message:"请选择影响范围",trigger:"change"}],estimatedRepairTime:[{required:!0,message:"请输入预计修复时间",trigger:"blur"}]},deviceGroupOptions:[],deviceOptions:[],faultTypeOptions:[{value:"mechanical",label:"机械故障"},{value:"electrical",label:"电气故障"},{value:"software",label:"软件故障"},{value:"network",label:"网络故障"},{value:"sensor",label:"传感器故障"},{value:"other",label:"其他"}],faultLevelOptions:[{value:"critical",label:"严重"},{value:"major",label:"主要"},{value:"minor",label:"次要"},{value:"warning",label:"警告"}]}},watch:{"entity.deviceGroupName":{handler(e){e?this.loadDeviceOptions(e):this.deviceOptions=[]}}},mounted(){this.loadDeviceGroupOptions()},methods:{loadDeviceGroupOptions(){this.deviceGroupOptions=[{value:"group1",label:"生产线设备组"},{value:"group2",label:"包装设备组"},{value:"group3",label:"测试设备组"}]},loadDeviceOptions(e){this.deviceOptions=[{value:"device1",label:"设备1"},{value:"device2",label:"设备2"},{value:"device3",label:"设备3"}]},submitFaultReport(){this.$refs.form.validate().then((e=>{e&&this.createSignModal()}))},createSignModal(){(0,s.f7)({title:"签名",width:"600px"},{component:r.Z,success:e=>{console.log(e),this.$message.success("故障报告提交成功"),this.refresh()}})},refresh(){this.entity={deviceGroupName:"",deviceName:"",faultType:void 0,faultLevel:void 0,discoveryTime:null,faultDescription:"",impactScope:[],estimatedRepairTime:1,impactDescription:""},this.$refs.form.resetFields()}}},n=o,c=a(1001),u=(0,c.Z)(n,l,i,!1,null,null,null),p=u.exports}}]);
//# sourceMappingURL=5133.0487d30c.js.map