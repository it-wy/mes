"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[1588],{81588:function(t,e,s){s.r(e),s.d(e,{default:function(){return l}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"screen-canvas-container"},[e("div",{ref:"screenCanvas",staticClass:"screen-canvas",style:t.canvasStyle},[e("div",{staticClass:"grid-background"}),t._l(t.charts,(function(s,r){return[e("div",{key:s.id,staticClass:"chart-item",class:{selected:t.selectedChartIndex===r},style:t.getChartStyle(s),on:{mousedown:function(e){return t.startDrag(e,s,r)},click:function(e){return e.stopPropagation(),t.selectChart(s,r)}}},[e("div",{ref:"chartContainer",refInFor:!0,staticClass:"chart-container",attrs:{id:s.id}})])]}))],2)])},a=[],n=s(61893),i=s(63844),h=s.n(i),c={name:"ScreenCanvas",data(){return{charts:[],chartInstances:{},erd:null,selectedChartIndex:-1,isDragging:!1,dragStartX:0,dragStartY:0,dragChart:null}},computed:{canvasStyle(){return{width:"100%",height:"100%",transformOrigin:"0 0",backgroundColor:"#0d2a42"}}},mounted(){this.initResizeDetector()},methods:{initResizeDetector(){this.erd=h()()},addChart(t){const e="chart_"+Date.now();this.charts.push({id:e,...t}),this.$nextTick((()=>{this.initChart(e,t)}))},initChart(t,e){const s=document.getElementById(t);if(!s)return;const r=n.S1(s);this.chartInstances[t]=r,this.erd.listenTo(s,(()=>{r.resize()})),r.setOption(e.option)},getChartStyle(t){return{position:"absolute",left:t.x+"px",top:t.y+"px",width:t.width+"px",height:t.height+"px"}},selectChart(t,e){this.selectedChartIndex=e,this.$emit("select-chart",{chart:t,index:e})},startDrag(t,e,s){this.isDragging=!0,this.dragChart=e,this.selectedChartIndex=s;const r=this.$refs.screenCanvas.getBoundingClientRect();this.dragStartX=t.clientX-(r.left+e.x),this.dragStartY=t.clientY-(r.top+e.y),document.addEventListener("mousemove",this.onDrag),document.addEventListener("mouseup",this.stopDrag),this.$emit("select-chart",{chart:e,index:s})},onDrag(t){if(!this.isDragging||!this.dragChart)return;const e=this.$refs.screenCanvas.getBoundingClientRect(),s=t.clientX-e.left-this.dragStartX,r=t.clientY-e.top-this.dragStartY;this.dragChart.x=Math.max(0,Math.round(s)),this.dragChart.y=Math.max(0,Math.round(r)),this.$emit("update-chart-position",{chart:this.dragChart,index:this.selectedChartIndex})},stopDrag(){this.isDragging=!1,document.removeEventListener("mousemove",this.onDrag),document.removeEventListener("mouseup",this.stopDrag)},updateChartData(t,e){const s=this.chartInstances[t];if(s){const t=s.getOption();t.series.forEach((t=>{t.data=e})),s.setOption(t)}},resizeChart(t){const e=this.chartInstances[t];e&&e.resize()}},beforeDestroy(){Object.values(this.chartInstances).forEach((t=>{t.dispose()})),this.erd&&this.erd.removeAllListeners(this.$refs.screenCanvas),document.removeEventListener("mousemove",this.onDrag),document.removeEventListener("mouseup",this.stopDrag)}},o=c,d=s(1001),u=(0,d.Z)(o,r,a,!1,null,"200f151c",null),l=u.exports}}]);
//# sourceMappingURL=1588.2bde0231.js.map