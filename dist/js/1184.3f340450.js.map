{"version":3,"file":"js/1184.3f340450.js","mappings":"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","sources":["webpack://data-v2/./src/views/setting/poster-design/components/PosterCanvas.vue?27e0","webpack://data-v2/src/views/setting/poster-design/components/PosterCanvas.vue","webpack://data-v2/./src/views/setting/poster-design/components/PosterCanvas.vue?31c7","webpack://data-v2/./src/views/setting/poster-design/components/PosterCanvas.vue"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"poster-canvas\",on:{\"dragover\":function($event){$event.preventDefault();},\"drop\":_vm.handleDrop}},[_c('div',{staticClass:\"canvas-container\"},[_c('div',{staticClass:\"canvas-grid\"}),_c('div',{staticClass:\"canvas-size-controller\"},[_c('a-input-number',{attrs:{\"min\":100,\"max\":2000},on:{\"change\":_vm.handleCanvasSizeChange},model:{value:(_vm.canvasWidth),callback:function ($$v) {_vm.canvasWidth=$$v},expression:\"canvasWidth\"}}),_c('span',{staticClass:\"size-separator\"},[_vm._v(\"×\")]),_c('a-input-number',{attrs:{\"min\":100,\"max\":2000},on:{\"change\":_vm.handleCanvasSizeChange},model:{value:(_vm.canvasHeight),callback:function ($$v) {_vm.canvasHeight=$$v},expression:\"canvasHeight\"}})],1),_c('div',{staticClass:\"canvas-content\",style:({\n        width: `${_vm.canvasWidth}px`,\n        height: `${_vm.canvasHeight}px`\n      })},_vm._l((_vm.value),function(element){return _c('div',{key:element.id,staticClass:\"canvas-element\",class:{\n          'is-selected': _vm.selectedElement?.id === element.id\n        },style:(_vm.getElementStyle(element)),on:{\"click\":function($event){$event.stopPropagation();return _vm.handleSelect(element)},\"mousedown\":function($event){$event.stopPropagation();return _vm.handleElementMouseDown($event, element)}}},[(element.type === 'text')?[_c('div',{staticClass:\"text-content\",style:(_vm.getTextStyle(element))},[_vm._v(\" \"+_vm._s(element.content)+\" \")])]:_vm._e(),(element.type === 'image')?[_c('img',{style:(_vm.getImageStyle(element)),attrs:{\"src\":element.url,\"draggable\":\"false\"}})]:_vm._e(),(element.type === 'shape')?[_c('div',{staticClass:\"shape-content\",style:(_vm.getShapeStyle(element))})]:_vm._e(),(element.type === 'qrcode')?[_c('div',{staticClass:\"qrcode-content\"},[_c('qrcode',{attrs:{\"value\":element.content,\"size\":Math.min(element.style.width, element.style.height),\"level\":\"H\",\"foreground\":element.style.color || '#000000',\"background\":element.style.backgroundColor || '#FFFFFF'}})],1)]:_vm._e(),(_vm.selectedElement?.id === element.id)?[_vm._l((_vm.controlPoints),function(point,index){return _c('div',{key:index,staticClass:\"control-point\",class:point.class,style:(_vm.getControlPointStyle(point)),on:{\"mousedown\":function($event){$event.stopPropagation();return _vm.handleControlPointMouseDown($event, point, element)}}})}),_c('div',{staticClass:\"rotate-handle\",on:{\"mousedown\":function($event){$event.stopPropagation();return _vm.handleRotateStart($event, element)}}})]:_vm._e()],2)}),0)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div \n    class=\"poster-canvas\"\n    @dragover.prevent\n    @drop=\"handleDrop\"\n  >\n    <div class=\"canvas-container\">\n      <!-- 网格背景 -->\n      <div class=\"canvas-grid\"></div>\n      \n      <!-- 画布尺寸控制器 -->\n      <div class=\"canvas-size-controller\">\n        <a-input-number\n          v-model:value=\"canvasWidth\"\n          :min=\"100\"\n          :max=\"2000\"\n          @change=\"handleCanvasSizeChange\"\n        />\n        <span class=\"size-separator\">×</span>\n        <a-input-number\n          v-model:value=\"canvasHeight\"\n          :min=\"100\"\n          :max=\"2000\"\n          @change=\"handleCanvasSizeChange\"\n        />\n      </div>\n      <!-- 元素列表 -->\n      <div \n        class=\"canvas-content\"\n        :style=\"{\n          width: `${canvasWidth}px`,\n          height: `${canvasHeight}px`\n        }\"\n      >\n        <div\n          v-for=\"element in value\"\n          :key=\"element.id\"\n          class=\"canvas-element\"\n          :class=\"{\n            'is-selected': selectedElement?.id === element.id\n          }\"\n          :style=\"getElementStyle(element)\"\n          @click.stop=\"handleSelect(element)\"\n          @mousedown.stop=\"handleElementMouseDown($event, element)\"\n        >\n          <!-- 文本元素 -->\n          <template v-if=\"element.type === 'text'\">\n            <div \n              class=\"text-content\"\n              :style=\"getTextStyle(element)\"\n            >\n              {{ element.content }}\n            </div>\n          </template>\n\n          <!-- 图片元素 -->\n          <template v-if=\"element.type === 'image'\">\n            <img \n              :src=\"element.url\"\n              :style=\"getImageStyle(element)\"\n              draggable=\"false\"\n            >\n          </template>\n\n          <!-- 形状元素 -->\n          <template v-if=\"element.type === 'shape'\">\n            <div \n              class=\"shape-content\"\n              :style=\"getShapeStyle(element)\"\n            ></div>\n          </template>\n\n          <!-- 二维码元素 -->\n          <template v-if=\"element.type === 'qrcode'\">\n            <div class=\"qrcode-content\">\n              <qrcode\n                :value=\"element.content\"\n                :size=\"Math.min(element.style.width, element.style.height)\"\n                level=\"H\"\n                :foreground=\"element.style.color || '#000000'\"\n                :background=\"element.style.backgroundColor || '#FFFFFF'\"\n              ></qrcode>\n            </div>\n          </template>\n\n          <!-- 选中时的控制点 -->\n          <template v-if=\"selectedElement?.id === element.id\">\n            <div \n              v-for=\"(point, index) in controlPoints\"\n              :key=\"index\"\n              class=\"control-point\"\n              :class=\"point.class\"\n              :style=\"getControlPointStyle(point)\"\n              @mousedown.stop=\"handleControlPointMouseDown($event, point, element)\"\n            ></div>\n            <div \n              class=\"rotate-handle\"\n              @mousedown.stop=\"handleRotateStart($event, element)\"\n            ></div>\n          </template>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport qrcode from 'qrcode.vue'\n\nexport default {\n  name: 'PosterCanvas',\n  components: {\n    qrcode\n  },\n  props: {\n    value: {\n      type: Array,\n      default: () => []\n    },\n    selectedElement: {\n      type: Object,\n      default: null\n    }\n  },\n  emits: ['update:value', 'select', 'change'],\n  data() {\n    return {\n      canvasWidth: 750,\n      canvasHeight: 1334,\n      isDragging: false,\n      startX: 0,\n      startY: 0,\n      originalPosition: null,\n      originalSize: null,\n      isResizing: false,\n      resizeType: '',\n      isRotating: false,\n      rotateStartAngle: 0,\n      controlPoints: [\n        { class: 'nw', cursor: 'nw-resize', x: 0, y: 0 },\n        { class: 'n', cursor: 'n-resize', x: 0.5, y: 0 },\n        { class: 'ne', cursor: 'ne-resize', x: 1, y: 0 },\n        { class: 'w', cursor: 'w-resize', x: 0, y: 0.5 },\n        { class: 'e', cursor: 'e-resize', x: 1, y: 0.5 },\n        { class: 'sw', cursor: 'sw-resize', x: 0, y: 1 },\n        { class: 's', cursor: 's-resize', x: 0.5, y: 1 },\n        { class: 'se', cursor: 'se-resize', x: 1, y: 1 }\n      ]\n    }\n  },\n  mounted() {\n    document.addEventListener('mousemove', this.handleMouseMove);\n    document.addEventListener('mouseup', this.handleMouseUp);\n  },\n  beforeUnmount() {\n    document.removeEventListener('mousemove', this.handleMouseMove);\n    document.removeEventListener('mouseup', this.handleMouseUp);\n  },\n  methods: {\n    handleDrop(event) {\n      event.preventDefault();\n      const componentType = event.dataTransfer.getData('componentType');\n      if (!componentType) return;\n\n      const rect = event.currentTarget.getBoundingClientRect();\n      const x = event.clientX - rect.left;\n      const y = event.clientY - rect.top;\n\n      this.$emit('add', {\n        type: componentType,\n        style: {\n          left: x,\n          top: y\n        }\n      });\n    },\n\n    handleSelect(element) {\n      this.$emit('select', element);\n    },\n\n    handleElementMouseDown(event, element) {\n      if (event.target.closest('.control-point') || event.target.closest('.rotate-handle')) {\n        return;\n      }\n      event.stopPropagation();\n      this.isDragging = true;\n      this.startX = event.clientX;\n      this.startY = event.clientY;\n      this.originalPosition = {\n        left: element.style.left,\n        top: element.style.top\n      };\n      this.handleSelect(element);\n    },\n\n    handleCanvasSizeChange() {\n      // 画布尺寸改变时，可能需要调整元素位置\n      this.$emit('change', this.value);\n    },\n\n    getElementStyle(element) {\n      return {\n        position: 'absolute',\n        left: `${element.style.left}px`,\n        top: `${element.style.top}px`,\n        width: `${element.style.width}px`,\n        height: `${element.style.height}px`,\n        transform: `rotate(${element.style.rotate || 0}deg)`,\n        opacity: (element.style.opacity || 100) / 100,\n        cursor: this.isDragging && this.selectedElement?.id === element.id ? 'move' : 'pointer'\n      }\n    },\n\n    getTextStyle(element) {\n      return {\n        fontFamily: element.style.fontFamily || 'Arial',\n        fontSize: `${element.style.fontSize || 14}px`,\n        color: element.style.color || '#000000',\n        textAlign: element.style.textAlign || 'left',\n        width: '100%',\n        height: '100%',\n        wordBreak: 'break-word',\n        overflow: 'hidden'\n      }\n    },\n\n    getImageStyle(element) {\n      return {\n        width: '100%',\n        height: '100%',\n        objectFit: element.style.objectFit || 'cover'\n      }\n    },\n\n    getShapeStyle(element) {\n      return {\n        width: '100%',\n        height: '100%',\n        backgroundColor: element.style.backgroundColor || '#000000',\n        borderRadius: element.style.borderRadius || '0'\n      }\n    },\n\n    getControlPointStyle(point) {\n      return {\n        left: `${point.x * 100}%`,\n        top: `${point.y * 100}%`,\n        cursor: point.cursor\n      }\n    },\n\n    handleControlPointMouseDown(event, point, element) {\n      event.stopPropagation();\n      this.isResizing = true;\n      this.resizeType = point.class;\n      this.startX = event.clientX;\n      this.startY = event.clientY;\n      this.originalSize = {\n        width: element.style.width,\n        height: element.style.height,\n        left: element.style.left,\n        top: element.style.top\n      };\n    },\n\n    handleRotateStart(event, element) {\n      event.stopPropagation();\n      this.isRotating = true;\n      // 获取元素的DOM节点\n      if(event.target.closest('.canvas-element')){\n      const elementRect = event.target.closest('.canvas-element').getBoundingClientRect();\n      const centerX = elementRect.left + elementRect.width / 2;\n      const centerY = elementRect.top + elementRect.height / 2;\n      this.rotateStartAngle = Math.atan2(\n        event.clientY - centerY,\n        event.clientX - centerX\n        ) * 180 / Math.PI - (element.style.rotate || 0);\n      }\n    },\n\n    handleMouseMove(event) {\n      if (!this.selectedElement) return;\n\n      if (this.isResizing) {\n        this.handleResize(event);\n      } else if (this.isRotating) {\n        this.handleRotate(event);\n      } else if (this.isDragging) {\n        this.handleDrag(event);\n      }\n    },\n\n    handleMouseUp() {\n      if (this.isResizing || this.isRotating || this.isDragging) {\n        this.$emit('change', this.value);\n      }\n      this.isResizing = false;\n      this.isRotating = false;\n      this.isDragging = false;\n    },\n\n    handleResize(event) {\n      const dx = event.clientX - this.startX;\n      const dy = event.clientY - this.startY;\n      const element = this.selectedElement;\n      const newStyle = { ...element.style };\n\n      switch (this.resizeType) {\n        case 'nw':\n          newStyle.width = this.originalSize.width - dx;\n          newStyle.height = this.originalSize.height - dy;\n          newStyle.left = this.originalSize.left + dx;\n          newStyle.top = this.originalSize.top + dy;\n          break;\n        case 'n':\n          newStyle.height = this.originalSize.height - dy;\n          newStyle.top = this.originalSize.top + dy;\n          break;\n        case 'ne':\n          newStyle.width = this.originalSize.width + dx;\n          newStyle.height = this.originalSize.height - dy;\n          newStyle.top = this.originalSize.top + dy;\n          break;\n        case 'w':\n          newStyle.width = this.originalSize.width - dx;\n          newStyle.left = this.originalSize.left + dx;\n          break;\n        case 'e':\n          newStyle.width = this.originalSize.width + dx;\n          break;\n        case 'sw':\n          newStyle.width = this.originalSize.width - dx;\n          newStyle.height = this.originalSize.height + dy;\n          newStyle.left = this.originalSize.left + dx;\n          break;\n        case 's':\n          newStyle.height = this.originalSize.height + dy;\n          break;\n        case 'se':\n          newStyle.width = this.originalSize.width + dx;\n          newStyle.height = this.originalSize.height + dy;\n          break;\n      }\n\n      // 限制最小尺寸\n      newStyle.width = Math.max(10, newStyle.width);\n      newStyle.height = Math.max(10, newStyle.height);\n\n      // 更新元素样式\n      element.style = newStyle;\n      this.$emit('update:value', [...this.value]);\n    },\n\n    handleRotate(event) {\n      const element = this.selectedElement;\n      // 获取元素的DOM节点\n      if(event.target.closest('.canvas-element')){\n        const elementRect = event.target.closest('.canvas-element').getBoundingClientRect();\n        const centerX = elementRect.left + elementRect.width / 2;\n        const centerY = elementRect.top + elementRect.height / 2;\n        const angle = Math.atan2(\n          event.clientY - centerY,\n          event.clientX - centerX\n        ) * 180 / Math.PI - this.rotateStartAngle;\n\n        element.style.rotate = angle;\n        this.$emit('update:value', [...this.value]);\n      }\n    },\n\n    handleDrag(event) {\n      const dx = event.clientX - this.startX;\n      const dy = event.clientY - this.startY;\n      const element = this.selectedElement;\n\n      element.style.left = this.originalPosition.left + dx;\n      element.style.top = this.originalPosition.top + dy;\n\n      this.$emit('update:value', [...this.value]);\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.poster-canvas {\n  flex: 1;\n  overflow: auto;\n  background-color: #f0f2f5;\n  padding: 20px;\n  position: relative;\n\n  .canvas-container {\n    position: relative;\n    display: inline-block;\n    padding-top: 50px;\n  }\n\n  .canvas-grid {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-size: 20px 20px;\n    background-image:\n      linear-gradient(to right, #e5e5e5 1px, transparent 1px),\n      linear-gradient(to bottom, #e5e5e5 1px, transparent 1px);\n  }\n\n  .canvas-size-controller {\n    position: absolute;\n    top: 10px;\n    left: 50%;\n    transform: translateX(-50%);\n    white-space: nowrap;\n    z-index: 10;\n    background-color: rgba(255, 255, 255, 0.9);\n    padding: 4px 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n    \n    .size-separator {\n      margin: 0 8px;\n      color: #999;\n    }\n  }\n\n  .canvas-content {\n    position: relative;\n    background-color: #fff;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n  }\n\n  .canvas-element {\n    position: absolute;\n    user-select: none;\n\n    &.is-selected {\n      outline: 1px solid #1890ff;\n    }\n\n    .text-content {\n      width: 100%;\n      height: 100%;\n      cursor: move;\n    }\n\n    img {\n      pointer-events: none;\n    }\n\n    .control-point {\n      position: absolute;\n      width: 8px;\n      height: 8px;\n      background-color: #fff;\n      border: 1px solid #1890ff;\n      border-radius: 50%;\n      transform: translate(-50%, -50%);\n    }\n\n    .rotate-handle {\n      position: absolute;\n      width: 8px;\n      height: 8px;\n      background-color: #1890ff;\n      border-radius: 50%;\n      left: 50%;\n      top: -30px;\n      transform: translateX(-50%);\n      cursor: pointer;\n      \n      &::before {\n        content: '';\n        position: absolute;\n        left: 50%;\n        top: 100%;\n        width: 1px;\n        height: 20px;\n        background-color: #1890ff;\n        transform: translateX(-50%);\n      }\n    }\n  }\n\n  .qrcode-content {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: #fff;\n  }\n}\n</style> ","import mod from \"-!../../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PosterCanvas.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PosterCanvas.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./PosterCanvas.vue?vue&type=template&id=0270f42a&scoped=true\"\nimport script from \"./PosterCanvas.vue?vue&type=script&lang=js\"\nexport * from \"./PosterCanvas.vue?vue&type=script&lang=js\"\nimport style0 from \"./PosterCanvas.vue?vue&type=style&index=0&id=0270f42a&prod&lang=less&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0270f42a\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","on","$event","preventDefault","handleDrop","attrs","handleCanvasSizeChange","model","value","callback","$$v","canvasWidth","expression","_v","canvasHeight","style","width","height","_l","element","key","id","class","selectedElement","getElementStyle","stopPropagation","handleSelect","handleElementMouseDown","type","getTextStyle","_s","content","_e","getImageStyle","url","getShapeStyle","Math","min","color","backgroundColor","point","index","getControlPointStyle","handleControlPointMouseDown","handleRotateStart","staticRenderFns","name","components","qrcode","props","Array","default","Object","emits","data","isDragging","startX","startY","originalPosition","originalSize","isResizing","resizeType","isRotating","rotateStartAngle","controlPoints","cursor","x","y","mounted","document","addEventListener","handleMouseMove","handleMouseUp","beforeUnmount","removeEventListener","methods","event","componentType","dataTransfer","getData","rect","currentTarget","getBoundingClientRect","clientX","left","clientY","top","$emit","target","closest","position","transform","rotate","opacity","fontFamily","fontSize","textAlign","wordBreak","overflow","objectFit","borderRadius","elementRect","centerX","centerY","atan2","PI","handleResize","handleRotate","handleDrag","dx","dy","newStyle","max","angle","component"],"sourceRoot":""}