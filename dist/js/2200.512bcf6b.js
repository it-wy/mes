"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[2200],{92200:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var i=function(){var e=this,t=e._self._c;return t("a-spin",{attrs:{spinning:e.loading}},[t("a-form-model",{ref:"form",attrs:{model:e.entity,rules:e.rules,autocomplete:"off",layout:"vertical"}},[t("div",{staticClass:"card"},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"conversionCode",attrs:{label:"转换编码",prop:"conversionCode"}},[t("a-input",{attrs:{placeholder:"请输入转换编码，格式为UC开头加4位数字",name:"conversionCode",disabled:!!e.ndoEditParams.row},on:{change:e.inChange},model:{value:e.entity.conversionCode,callback:function(t){e.$set(e.entity,"conversionCode",t)},expression:"entity.conversionCode"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"name",attrs:{label:"转换名称",prop:"name"}},[t("a-input",{attrs:{placeholder:"请输入转换名称",name:"name"},on:{change:e.inChange},model:{value:e.entity.name,callback:function(t){e.$set(e.entity,"name",t)},expression:"entity.name"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"status",attrs:{label:"状态",prop:"status"}},[t("a-radio-group",{attrs:{name:"status"},model:{value:e.entity.status,callback:function(t){e.$set(e.entity,"status",t)},expression:"entity.status"}},[t("a-radio",{attrs:{value:"启用"}},[e._v("启用")]),t("a-radio",{attrs:{value:"禁用"}},[e._v("禁用")])],1)],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"unitType",attrs:{label:"单位类型",prop:"unitType"}},[t("a-select",{attrs:{placeholder:"请选择单位类型",name:"unitType"},on:{change:e.handleUnitTypeChange},model:{value:e.entity.unitType,callback:function(t){e.$set(e.entity,"unitType",t)},expression:"entity.unitType"}},[t("a-select-option",{attrs:{value:"长度单位"}},[e._v("长度单位")]),t("a-select-option",{attrs:{value:"重量单位"}},[e._v("重量单位")]),t("a-select-option",{attrs:{value:"面积单位"}},[e._v("面积单位")]),t("a-select-option",{attrs:{value:"体积单位"}},[e._v("体积单位")]),t("a-select-option",{attrs:{value:"温度单位"}},[e._v("温度单位")]),t("a-select-option",{attrs:{value:"时间单位"}},[e._v("时间单位")]),t("a-select-option",{attrs:{value:"速度单位"}},[e._v("速度单位")]),t("a-select-option",{attrs:{value:"其他单位"}},[e._v("其他单位")])],1)],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"sourceUnit",attrs:{label:"源单位",prop:"sourceUnit"}},[t("a-select",{attrs:{placeholder:"请选择源单位",name:"sourceUnit",disabled:!e.entity.unitType},model:{value:e.entity.sourceUnit,callback:function(t){e.$set(e.entity,"sourceUnit",t)},expression:"entity.sourceUnit"}},e._l(e.sourceUnitOptions,(function(a){return t("a-select-option",{key:a.value,attrs:{value:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1)],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"targetUnit",attrs:{label:"目标单位",prop:"targetUnit"}},[t("a-select",{attrs:{placeholder:"请选择目标单位",name:"targetUnit",disabled:!e.entity.unitType},model:{value:e.entity.targetUnit,callback:function(t){e.$set(e.entity,"targetUnit",t)},expression:"entity.targetUnit"}},e._l(e.targetUnitOptions,(function(a){return t("a-select-option",{key:a.value,attrs:{value:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1)],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"bidirectional",attrs:{label:"反向可用",prop:"bidirectional"}},[t("a-switch",{model:{value:e.entity.bidirectional,callback:function(t){e.$set(e.entity,"bidirectional",t)},expression:"entity.bidirectional"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"conversionRatio",attrs:{label:"转换比率",prop:"conversionRatio"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:6,placeholder:"请输入转换比率",name:"conversionRatio"},model:{value:e.entity.conversionRatio,callback:function(t){e.$set(e.entity,"conversionRatio",t)},expression:"entity.conversionRatio"}})],1)],1),t("a-col",{attrs:{sm:12}},[t("a-form-model-item",{ref:"conversionFormula",attrs:{label:"转换公式",prop:"conversionFormula"}},[t("a-input",{attrs:{placeholder:"请输入转换公式，如：源单位 × 100",name:"conversionFormula"},model:{value:e.entity.conversionFormula,callback:function(t){e.$set(e.entity,"conversionFormula",t)},expression:"entity.conversionFormula"}})],1)],1),t("a-col",{attrs:{sm:12}},[t("a-form-model-item",{ref:"description",attrs:{label:"单位描述",prop:"description"}},[t("a-textarea",{attrs:{placeholder:"请输入描述",rows:2,"max-length":500,name:"description"},model:{value:e.entity.description,callback:function(t){e.$set(e.entity,"description",t)},expression:"entity.description"}})],1)],1)],1)],1),t("g-collapse",{attrs:{headerName:"转换示例"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{sm:24}},[t("a-button",{staticClass:"add-example-btn",attrs:{type:"primary",icon:"plus"},on:{click:e.addExample}},[e._v("添加示例")])],1),t("a-col",{attrs:{sm:24}},[t("a-table",{attrs:{columns:e.exampleColumns,dataSource:e.entity.examples,pagination:!1,size:"small",rowKey:"id"},scopedSlots:e._u([{key:"sourceValue",fn:function(a,i,n){return[t("a-input-number",{staticStyle:{width:"100%"},attrs:{precision:3,placeholder:"请输入源值"},model:{value:e.entity.examples[n].sourceValue,callback:function(t){e.$set(e.entity.examples[n],"sourceValue",t)},expression:"entity.examples[index].sourceValue"}})]}},{key:"targetValue",fn:function(a,i,n){return[t("a-input-number",{staticStyle:{width:"100%"},attrs:{precision:3,placeholder:"请输入目标值"},model:{value:e.entity.examples[n].targetValue,callback:function(t){e.$set(e.entity.examples[n],"targetValue",t)},expression:"entity.examples[index].targetValue"}})]}},{key:"note",fn:function(a,i,n){return[t("a-input",{attrs:{placeholder:"请输入说明"},model:{value:e.entity.examples[n].note,callback:function(t){e.$set(e.entity.examples[n],"note",t)},expression:"entity.examples[index].note"}})]}},{key:"action",fn:function(a,i,n){return[t("a-button",{staticStyle:{"margin-right":"8px"},attrs:{type:"primary",icon:"calculator",size:"small"},on:{click:()=>e.calculateTargetValue(n)}}),t("a-button",{attrs:{type:"danger",icon:"delete",size:"small"},on:{click:()=>e.removeExample(n)}})]}}])})],1)],1)]},proxy:!0}])}),t("g-collapse",{attrs:{headerName:"详细信息"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"创建人"}},[t("span",[e._v(e._s(e.entity.createdBy||"未知"))])])],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"创建时间"}},[t("span",[e._v(e._s(e.entity.createdTime||"未知"))])])],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"修改人"}},[t("span",[e._v(e._s(e.entity.modifiedBy||"未知"))])])],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"修改时间"}},[t("span",[e._v(e._s(e.entity.modifiedTime||"未知"))])])],1)],1)]},proxy:!0}])})],1)],1)},n=[],l=a(36026),s={name:"CreateOrEditUnitConversion",mixins:[l.GE],data(){return{loading:!1,entity:{id:void 0,conversionCode:"",name:"",unitType:"",sourceUnit:"",targetUnit:"",conversionRatio:1,conversionFormula:"",bidirectional:!1,description:"",examples:[],status:"启用",createdBy:"",createdTime:"",modifiedBy:"",modifiedTime:""},sourceUnitOptions:[],targetUnitOptions:[],unitMap:{"长度单位":[{label:"米",value:"米"},{label:"厘米",value:"厘米"},{label:"毫米",value:"毫米"},{label:"千米",value:"千米"},{label:"英寸",value:"英寸"},{label:"英尺",value:"英尺"}],"重量单位":[{label:"千克",value:"千克"},{label:"克",value:"克"},{label:"毫克",value:"毫克"},{label:"吨",value:"吨"},{label:"磅",value:"磅"}],"面积单位":[{label:"平方米",value:"平方米"},{label:"平方厘米",value:"平方厘米"},{label:"平方千米",value:"平方千米"},{label:"公顷",value:"公顷"},{label:"亩",value:"亩"}],"体积单位":[{label:"立方米",value:"立方米"},{label:"立方厘米",value:"立方厘米"},{label:"升",value:"升"},{label:"毫升",value:"毫升"},{label:"加仑",value:"加仑"}],"温度单位":[{label:"摄氏度",value:"摄氏度"},{label:"华氏度",value:"华氏度"},{label:"开尔文",value:"开尔文"}],"时间单位":[{label:"秒",value:"秒"},{label:"分钟",value:"分钟"},{label:"小时",value:"小时"},{label:"天",value:"天"},{label:"周",value:"周"}],"速度单位":[{label:"米/秒",value:"米/秒"},{label:"千米/小时",value:"千米/小时"},{label:"英里/小时",value:"英里/小时"},{label:"节",value:"节"}],"其他单位":[]},rules:{conversionCode:[{required:!0,message:"请输入转换编码",trigger:"change"},{pattern:/^UC\d{4}$/,message:"转换编码必须为UC开头加4位数字",trigger:"change"}],name:[{required:!0,message:"请输入转换名称",trigger:"change"},{pattern:/^[^\s]+(\s+[^\s]+)*$/,message:"转换名称不能包含前后空格",trigger:"change"}],unitType:[{required:!0,message:"请选择单位类型",trigger:"change"}],sourceUnit:[{required:!0,message:"请选择源单位",trigger:"change"}],targetUnit:[{required:!0,message:"请选择目标单位",trigger:"change"}],conversionRatio:[{required:!0,message:"请输入转换比率",trigger:"change"},{type:"number",min:0,message:"转换比率不能小于0",trigger:"change"}],conversionFormula:[{required:!0,message:"请输入转换公式",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},exampleColumns:[{title:"源值",dataIndex:"sourceValue",key:"sourceValue",width:"25%",scopedSlots:{customRender:"sourceValue"}},{title:"目标值",dataIndex:"targetValue",key:"targetValue",width:"25%",scopedSlots:{customRender:"targetValue"}},{title:"说明",dataIndex:"note",key:"note",width:"30%",scopedSlots:{customRender:"note"}},{title:"操作",key:"action",width:"20%",scopedSlots:{customRender:"action"}}]}},methods:{init(){console.log(this.id,"初始化"),this.loading=!0,this.id?setTimeout((()=>{this.initFormData(),this.loading=!1}),500):(this.reset(),this.loading=!1)},resetFormData(){this.entity={id:void 0,conversionCode:"",name:"",unitType:"",sourceUnit:"",targetUnit:"",conversionRatio:1,conversionFormula:"",bidirectional:!1,description:"",examples:[],status:"启用",createdBy:"",createdTime:"",modifiedBy:"",modifiedTime:""},this.sourceUnitOptions=[],this.targetUnitOptions=[]},initFormData(){if(this.ndoEditParams.row){const e=this.ndoEditParams.row;this.entity={...this.entity,...e,examples:e.examples||[]},e.unitType&&this.handleUnitTypeChange(e.unitType)}},async save(){let e=await this.checkError();if(e){if(this.entity.sourceUnit===this.entity.targetUnit)return void this.$message.error("源单位和目标单位不能相同");this.loading=!0,setTimeout((()=>{this.loading=!1,this.saveSuccess(this.entity.name),this.handleSaveEndBackView(this.id),this.refreshParent({reset:null})}),500)}},inChange(e){console.log(e.target.value)},handleUnitTypeChange(e){this.unitMap[e]?(this.sourceUnitOptions=[...this.unitMap[e]],this.targetUnitOptions=[...this.unitMap[e]],this.entity.unitType!==e&&(this.entity.sourceUnit="",this.entity.targetUnit="")):(this.sourceUnitOptions=[],this.targetUnitOptions=[])},addExample(){this.entity.examples.push({id:Date.now(),sourceValue:1,targetValue:null,note:""})},removeExample(e){this.entity.examples.splice(e,1)},calculateTargetValue(e){const t=this.entity.examples[e];t&&this.entity.conversionRatio>0&&(t.targetValue=t.sourceValue*this.entity.conversionRatio,t.note||(t.note=`${t.sourceValue} ${this.entity.sourceUnit} = ${t.targetValue} ${this.entity.targetUnit}`))}}},o=s,r=a(1001),c=(0,r.Z)(o,i,n,!1,null,"0e36a9a4",null),u=c.exports}}]);
//# sourceMappingURL=2200.512bcf6b.js.map