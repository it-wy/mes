"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[5844],{65844:function(e,t,a){a.r(t),a.d(t,{default:function(){return l}});var n=function(){var e=this,t=e._self._c;return t("a-spin",{attrs:{spinning:e.loading}},[t("a-form-model",{ref:"form",attrs:{model:e.entity,rules:e.rules,autocomplete:"off",layout:"vertical"}},[t("div",{staticClass:"card"},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"craftCode",attrs:{label:"工艺编码",prop:"craftCode"}},[t("a-input",{attrs:{placeholder:"请输入工艺编码",name:"craftCode",disabled:!!e.ndoEditParams.row},on:{change:e.inChange},model:{value:e.entity.craftCode,callback:function(t){e.$set(e.entity,"craftCode",t)},expression:"entity.craftCode"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"name",attrs:{label:"工艺名称",prop:"name"}},[t("a-input",{attrs:{placeholder:"请输入工艺名称",name:"name"},on:{change:e.inChange},model:{value:e.entity.name,callback:function(t){e.$set(e.entity,"name",t)},expression:"entity.name"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"craftType",attrs:{label:"工艺类型",prop:"craftType"}},[t("a-select",{attrs:{placeholder:"请选择工艺类型",name:"craftType"},model:{value:e.entity.craftType,callback:function(t){e.$set(e.entity,"craftType",t)},expression:"entity.craftType"}},[t("a-select-option",{attrs:{value:"机械加工工艺"}},[e._v("机械加工工艺")]),t("a-select-option",{attrs:{value:"装配工艺"}},[e._v("装配工艺")]),t("a-select-option",{attrs:{value:"焊接工艺"}},[e._v("焊接工艺")]),t("a-select-option",{attrs:{value:"热处理工艺"}},[e._v("热处理工艺")]),t("a-select-option",{attrs:{value:"表面处理工艺"}},[e._v("表面处理工艺")]),t("a-select-option",{attrs:{value:"检验工艺"}},[e._v("检验工艺")])],1)],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"productType",attrs:{label:"产品类型",prop:"productType"}},[t("a-select",{attrs:{placeholder:"请选择产品类型",name:"productType"},model:{value:e.entity.productType,callback:function(t){e.$set(e.entity,"productType",t)},expression:"entity.productType"}},[t("a-select-option",{attrs:{value:"金属结构件"}},[e._v("金属结构件")]),t("a-select-option",{attrs:{value:"电子产品"}},[e._v("电子产品")]),t("a-select-option",{attrs:{value:"机械设备"}},[e._v("机械设备")]),t("a-select-option",{attrs:{value:"汽车零部件"}},[e._v("汽车零部件")]),t("a-select-option",{attrs:{value:"航空零件"}},[e._v("航空零件")]),t("a-select-option",{attrs:{value:"医疗器械"}},[e._v("医疗器械")])],1)],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"version",attrs:{label:"版本",prop:"version"}},[t("a-input",{attrs:{placeholder:"请输入版本号",name:"version"},model:{value:e.entity.version,callback:function(t){e.$set(e.entity,"version",t)},expression:"entity.version"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{ref:"status",attrs:{label:"状态",prop:"status"}},[t("a-select",{attrs:{placeholder:"请选择状态",name:"status"},model:{value:e.entity.status,callback:function(t){e.$set(e.entity,"status",t)},expression:"entity.status"}},[t("a-select-option",{attrs:{value:"已发布"}},[e._v("已发布")]),t("a-select-option",{attrs:{value:"草稿"}},[e._v("草稿")]),t("a-select-option",{attrs:{value:"审核中"}},[e._v("审核中")]),t("a-select-option",{attrs:{value:"已废弃"}},[e._v("已废弃")])],1)],1)],1),t("a-col",{attrs:{sm:24}},[t("a-form-model-item",{ref:"description",attrs:{label:"工艺描述",prop:"description"}},[t("a-textarea",{attrs:{placeholder:"请输入工艺描述",rows:3,"max-length":500,name:"description"},model:{value:e.entity.description,callback:function(t){e.$set(e.entity,"description",t)},expression:"entity.description"}})],1)],1)],1)],1),t("g-collapse",{attrs:{headerName:"工序清单"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{sm:24}},[t("a-button",{staticClass:"add-operation-btn",attrs:{type:"primary",icon:"plus"},on:{click:e.addOperation}},[e._v("添加工序")])],1),t("a-col",{attrs:{sm:24}},[t("a-table",{attrs:{columns:e.operationColumns,dataSource:e.entity.operations,pagination:!1,size:"small",rowKey:"id"},scopedSlots:e._u([{key:"sequence",fn:function(a,n,o){return[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1,placeholder:"请输入序号"},model:{value:e.entity.operations[o].sequence,callback:function(t){e.$set(e.entity.operations[o],"sequence",t)},expression:"entity.operations[index].sequence"}})]}},{key:"operationCode",fn:function(a,n,o){return[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择工序"},on:{change:t=>e.handleOperationChange(t,o)},model:{value:e.entity.operations[o].operationCode,callback:function(t){e.$set(e.entity.operations[o],"operationCode",t)},expression:"entity.operations[index].operationCode"}},e._l(e.operationOptions,(function(a){return t("a-select-option",{key:a.code,attrs:{value:a.code}},[e._v(" "+e._s(a.name)+" ")])})),1)]}},{key:"operationName",fn:function(a,n,o){return[t("span",[e._v(e._s(e.entity.operations[o].operationName))])]}},{key:"department",fn:function(a,n,o){return[t("span",[e._v(e._s(e.entity.operations[o].department))])]}},{key:"standardTime",fn:function(a,n,o){return[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,placeholder:"请输入标准工时"},model:{value:e.entity.operations[o].standardTime,callback:function(t){e.$set(e.entity.operations[o],"standardTime",t)},expression:"entity.operations[index].standardTime"}})]}},{key:"standardUnit",fn:function(a,n,o){return[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择单位"},model:{value:e.entity.operations[o].standardUnit,callback:function(t){e.$set(e.entity.operations[o],"standardUnit",t)},expression:"entity.operations[index].standardUnit"}},[t("a-select-option",{attrs:{value:"秒"}},[e._v("秒")]),t("a-select-option",{attrs:{value:"分钟"}},[e._v("分钟")]),t("a-select-option",{attrs:{value:"小时"}},[e._v("小时")])],1)]}},{key:"remark",fn:function(a,n,o){return[t("a-input",{attrs:{placeholder:"请输入备注"},model:{value:e.entity.operations[o].remark,callback:function(t){e.$set(e.entity.operations[o],"remark",t)},expression:"entity.operations[index].remark"}})]}},{key:"action",fn:function(a,n,o){return[t("a-button",{attrs:{type:"danger",icon:"delete",size:"small"},on:{click:()=>e.removeOperation(o)}})]}}])})],1)],1)]},proxy:!0}])}),t("g-collapse",{attrs:{headerName:"工艺要求"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{sm:24}},[t("a-button",{staticClass:"add-requirement-btn",attrs:{type:"primary",icon:"plus"},on:{click:e.addRequirement}},[e._v("添加要求")])],1),t("a-col",{attrs:{sm:24}},[t("a-table",{attrs:{columns:e.requirementColumns,dataSource:e.entity.requirements,pagination:!1,size:"small",rowKey:"id"},scopedSlots:e._u([{key:"category",fn:function(a,n,o){return[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类别"},model:{value:e.entity.requirements[o].category,callback:function(t){e.$set(e.entity.requirements[o],"category",t)},expression:"entity.requirements[index].category"}},[t("a-select-option",{attrs:{value:"质量要求"}},[e._v("质量要求")]),t("a-select-option",{attrs:{value:"安全要求"}},[e._v("安全要求")]),t("a-select-option",{attrs:{value:"工艺要求"}},[e._v("工艺要求")]),t("a-select-option",{attrs:{value:"设备要求"}},[e._v("设备要求")]),t("a-select-option",{attrs:{value:"材料要求"}},[e._v("材料要求")]),t("a-select-option",{attrs:{value:"环境要求"}},[e._v("环境要求")]),t("a-select-option",{attrs:{value:"其他要求"}},[e._v("其他要求")])],1)]}},{key:"content",fn:function(a,n,o){return[t("a-textarea",{attrs:{placeholder:"请输入要求内容",rows:2,"auto-size":{minRows:2,maxRows:4}},model:{value:e.entity.requirements[o].content,callback:function(t){e.$set(e.entity.requirements[o],"content",t)},expression:"entity.requirements[index].content"}})]}},{key:"importance",fn:function(a,n,o){return[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择重要性"},model:{value:e.entity.requirements[o].importance,callback:function(t){e.$set(e.entity.requirements[o],"importance",t)},expression:"entity.requirements[index].importance"}},[t("a-select-option",{attrs:{value:"高"}},[e._v("高")]),t("a-select-option",{attrs:{value:"中"}},[e._v("中")]),t("a-select-option",{attrs:{value:"低"}},[e._v("低")])],1)]}},{key:"action",fn:function(a,n,o){return[t("a-button",{attrs:{type:"danger",icon:"delete",size:"small"},on:{click:()=>e.removeRequirement(o)}})]}}])})],1)],1)]},proxy:!0}])}),t("g-collapse",{attrs:{headerName:"详细信息"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"创建人"}},[t("span",[e._v(e._s(e.entity.createdBy||"未知"))])])],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"创建时间"}},[t("span",[e._v(e._s(e.entity.createdTime||"未知"))])])],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"修改人"}},[t("span",[e._v(e._s(e.entity.modifiedBy||"未知"))])])],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"修改时间"}},[t("span",[e._v(e._s(e.entity.modifiedTime||"未知"))])])],1)],1)]},proxy:!0}])})],1)],1)},o=[],i=a(36026),r={name:"CreateOrEditCraft",mixins:[i.GE],data(){return{loading:!1,entity:{id:void 0,craftCode:"",name:"",craftType:"",productType:"",version:"",description:"",operations:[],requirements:[],status:"草稿",createdBy:"",createdTime:"",modifiedBy:"",modifiedTime:""},operationOptions:[{code:"OP00101",name:"车削",department:"机加部",time:30,unit:"分钟"},{code:"OP00202",name:"铣削",department:"机加部",time:45,unit:"分钟"},{code:"OP00303",name:"钻孔",department:"机加部",time:25,unit:"分钟"},{code:"OP00404",name:"磨削",department:"机加部",time:40,unit:"分钟"},{code:"AS00105",name:"组装主体",department:"装配部",time:60,unit:"分钟"},{code:"AS00206",name:"连接零件",department:"装配部",time:45,unit:"分钟"},{code:"AS00307",name:"固定紧固",department:"装配部",time:30,unit:"分钟"},{code:"IN00108",name:"尺寸检验",department:"质检部",time:20,unit:"分钟"},{code:"IN00209",name:"外观检验",department:"质检部",time:15,unit:"分钟"},{code:"IN00310",name:"功能测试",department:"质检部",time:30,unit:"分钟"},{code:"HT00111",name:"淬火",department:"热处理部",time:120,unit:"分钟"},{code:"HT00212",name:"回火",department:"热处理部",time:180,unit:"分钟"},{code:"HT00313",name:"退火",department:"热处理部",time:240,unit:"分钟"},{code:"SF00114",name:"喷漆",department:"表面处理部",time:50,unit:"分钟"},{code:"SF00215",name:"电镀",department:"表面处理部",time:90,unit:"分钟"},{code:"SF00316",name:"抛光",department:"表面处理部",time:40,unit:"分钟"},{code:"PK00117",name:"内包装",department:"包装部",time:15,unit:"分钟"},{code:"PK00218",name:"外包装",department:"包装部",time:20,unit:"分钟"}],rules:{craftCode:[{required:!0,message:"请输入工艺编码",trigger:"change"},{pattern:/^[A-Z]{2}\d{3}/,message:"工艺编码格式不正确",trigger:"change"}],name:[{required:!0,message:"请输入工艺名称",trigger:"change"},{pattern:/^[^\s]+(\s+[^\s]+)*$/,message:"工艺名称不能包含前后空格",trigger:"change"}],craftType:[{required:!0,message:"请选择工艺类型",trigger:"change"}],productType:[{required:!0,message:"请选择产品类型",trigger:"change"}],version:[{required:!0,message:"请输入版本号",trigger:"change"},{pattern:/^V\d+\.\d+$/,message:"版本号格式不正确，应为Vx.x格式",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},operationColumns:[{title:"序号",dataIndex:"sequence",key:"sequence",width:"8%",scopedSlots:{customRender:"sequence"}},{title:"工序",dataIndex:"operationCode",key:"operationCode",width:"20%",scopedSlots:{customRender:"operationCode"}},{title:"工序名称",dataIndex:"operationName",key:"operationName",width:"15%",scopedSlots:{customRender:"operationName"}},{title:"部门",dataIndex:"department",key:"department",width:"12%",scopedSlots:{customRender:"department"}},{title:"标准工时",dataIndex:"standardTime",key:"standardTime",width:"12%",scopedSlots:{customRender:"standardTime"}},{title:"单位",dataIndex:"standardUnit",key:"standardUnit",width:"10%",scopedSlots:{customRender:"standardUnit"}},{title:"备注",dataIndex:"remark",key:"remark",width:"15%",scopedSlots:{customRender:"remark"}},{title:"操作",key:"action",width:"8%",scopedSlots:{customRender:"action"}}],requirementColumns:[{title:"类别",dataIndex:"category",key:"category",width:"15%",scopedSlots:{customRender:"category"}},{title:"要求内容",dataIndex:"content",key:"content",width:"65%",scopedSlots:{customRender:"content"}},{title:"重要性",dataIndex:"importance",key:"importance",width:"10%",scopedSlots:{customRender:"importance"}},{title:"操作",key:"action",width:"10%",scopedSlots:{customRender:"action"}}]}},methods:{init(){console.log(this.id,"初始化"),this.loading=!0,this.id?setTimeout((()=>{this.initFormData(),this.loading=!1}),500):(this.reset(),this.loading=!1)},resetFormData(){this.entity={id:void 0,craftCode:"",name:"",craftType:"",productType:"",version:"",description:"",operations:[],requirements:[],status:"草稿",createdBy:"",createdTime:"",modifiedBy:"",modifiedTime:""}},initFormData(){if(this.ndoEditParams.row){const e=this.ndoEditParams.row;this.entity={...this.entity,...e,operations:e.operations||[],requirements:e.requirements||[]}}},async save(){let e=await this.checkError();e&&(this.loading=!0,setTimeout((()=>{this.loading=!1,this.saveSuccess(this.entity.name),this.handleSaveEndBackView(this.id),this.refreshParent({reset:null})}),500))},inChange(e){console.log(e.target.value)},handleOperationChange(e,t){const a=this.operationOptions.find((t=>t.code===e));a&&(this.entity.operations[t].operationName=a.name,this.entity.operations[t].department=a.department,this.entity.operations[t].standardTime=a.time,this.entity.operations[t].standardUnit=a.unit)},addOperation(){const e=this.entity.operations.length>0?Math.max(...this.entity.operations.map((e=>e.sequence)))+10:10;this.entity.operations.push({id:Date.now(),sequence:e,operationCode:"",operationName:"",department:"",standardTime:0,standardUnit:"分钟",remark:""})},removeOperation(e){this.entity.operations.splice(e,1)},addRequirement(){this.entity.requirements.push({id:Date.now(),category:"",content:"",importance:"中"})},removeRequirement(e){this.entity.requirements.splice(e,1)}}},s=r,c=a(1001),d=(0,c.Z)(s,n,o,!1,null,"70100ad1",null),l=d.exports}}]);
//# sourceMappingURL=5844.9ac67cd8.js.map