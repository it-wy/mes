"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[504],{8910:function(t,e,a){a.d(e,{Z:function(){return d}});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"modal"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"sign-container"},[e("h3",{staticClass:"sign-title"},[t._v(t._s(t.title||"请在下方区域签名"))]),e("g-sign",{ref:"signBoard",attrs:{"line-width":t.lineWidth,"line-color":t.lineColor,"background-color":t.backgroundColor,"save-format":t.saveFormat},on:{save:t.handleSave,clear:t.handleClear,"save-error":t.handleError}})],1)]),e("div",{staticClass:"modal-footer"},[e("g-btn",{attrs:{text:"确认",type:"primary"},on:{callback:t.save}}),e("g-btn",{attrs:{text:"取消"},on:{callback:function(e){return t.$emit("closeModal")}}})],1)])},r=[],s=a(60704),o={name:"GSignModal",components:{GSign:s.Z},props:{title:{type:String,default:""},lineWidth:{type:Number,default:2},lineColor:{type:String,default:"#000000"},backgroundColor:{type:String,default:"#ffffff"},saveFormat:{type:String,default:"png",validator:t=>["png","jpeg","webp"].includes(t)}},data(){return{signatureData:null,hasSignature:!1}},methods:{handleSave(t){this.signatureData=t,this.hasSignature=!0},handleClear(){this.signatureData=null,this.hasSignature=!1},handleError(t){this.$message.error(t)},save(){this.hasSignature?(this.$emit("success",this.signatureData),this.$emit("closeModal")):this.$message.error("请先进行签名")},clearSignature(){this.$refs.signBoard&&this.$refs.signBoard.clearCanvas()}}},i=o,l=a(1001),c=(0,l.Z)(i,n,r,!1,null,"e39a081c",null),d=c.exports},70504:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var n=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("a-form-model",{ref:"form",staticClass:"h-father sflex",attrs:{model:t.entity,layout:"vertical",autocomplete:"off",rules:t.rules}},[e("a-card",{staticClass:"mb-4"},[e("a-radio-group",{on:{change:t.combineTypeChange},model:{value:t.combineType,callback:function(e){t.combineType=e},expression:"combineType"}},[e("a-radio",{attrs:{value:"1"}},[t._v("一个批次合并到多个批次")]),e("a-radio",{attrs:{value:"2"}},[t._v("多个批次合并到一个批次")])],1)],1),e("g-body-form-layout",{scopedSlots:t._u([{key:"search-card",fn:function(){return[e("div",{staticClass:"search-card"},[e("g-container-list",{attrs:{value:t.entity.containerName},on:{"update:value":function(e){return t.$set(t.entity,"containerName",e)},searchClick:t.onSearch}})],1)]},proxy:!0},{key:"expand-card",fn:function(){return[e("div",{staticClass:"expand-card"},[e("g-collapse",{attrs:{headerName:"扩展信息"},scopedSlots:t._u([{key:"content",fn:function(){return[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:4}},[e("a-form-model-item",{attrs:{label:"设备"}},[e("g-select",{attrs:{showSearch:!0,loadType:"scroll"},on:{change:t.resourceChange},model:{value:t.entity.resourceId,callback:function(e){t.$set(t.entity,"resourceId",e)},expression:"entity.resourceId"}})],1)],1)],1)]},proxy:!0}])})],1)]},proxy:!0},{key:"card-body",fn:function(){return[e("g-collapse",{attrs:{headerName:"合并信息"},scopedSlots:t._u([{key:"content",fn:function(){return[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:24}},[e("a-button",{attrs:{type:"primary"},on:{click:t.addDetailRow}},[t._v("添加批次")]),e("a-table",{staticClass:"mt-4",attrs:{dataSource:t.detailList,columns:t.columns,pagination:!1},scopedSlots:t._u([{key:"bodyCell",fn:function({column:a,record:n,index:r}){return["action"===a.key?[e("a-space",[e("a-popconfirm",{attrs:{title:"确认删除?"},on:{confirm:function(e){return t.deleteDetailRow(n,r)}}},[e("a",[t._v("删除")])])],1)]:t._e()]}}])}),"2"===t.combineType?[e("a-table",{staticClass:"mt-4",attrs:{dataSource:t.newContainer,columns:t.newContainerColumns,pagination:!1},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("合并后批次")]},proxy:!0}],null,!1,1421813205)})]:t._e()],2)],1),e("a-row",{staticClass:"mt-4",attrs:{gutter:24}},[e("a-col",{attrs:{span:8}},[e("a-form-model-item",{attrs:{label:"合并原因",prop:"mergeReasonId",rules:[{required:!0,message:"请选择合并原因"}]}},[e("g-select",{model:{value:t.entity.mergeReasonId,callback:function(e){t.$set(t.entity,"mergeReasonId",e)},expression:"entity.mergeReasonId"}})],1)],1)],1)]},proxy:!0}])}),t.dataPoints.length?e("g-collapse",{attrs:{headerName:"数据采集"},scopedSlots:t._u([{key:"content",fn:function(){return[e("g-data-points",{attrs:{dataPoints:t.dataPoints,validDataName:"dataPoints"}})]},proxy:!0}],null,!1,1867507197)}):t._e(),t.ppcDataPoints.length?e("g-collapse",{attrs:{headerName:"工艺参数"},scopedSlots:t._u([{key:"content",fn:function(){return[e("g-data-points",{attrs:{dataPoints:t.ppcDataPoints,validDataName:"ppcDataPoints"}})]},proxy:!0}],null,!1,4096235805)}):t._e(),e("g-collapse",{attrs:{headerName:"操作描述"},scopedSlots:t._u([{key:"content",fn:function(){return[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:12}},[e("a-form-model-item",{attrs:{label:"描述"}},[e("a-textarea",{attrs:{rows:4,maxLength:1e3,placeholder:"请输入操作描述"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1)],1)],1)]},proxy:!0}])})]},proxy:!0},{key:"g-fixed-row",fn:function(){return[e("div",{staticClass:"g-fixed-row"},[e("g-btn",{attrs:{size:"large",text:"刷新"},on:{callback:t.refresh}}),e("g-btn",{attrs:{size:"large",text:"提交",type:"primary"},on:{callback:t.save}})],1)]},proxy:!0}])})],1)},r=[],s=a(20144),o=a(8910),i=a(36026),l=(0,s.aZ)({name:"DataV2CombineQty",data(){return{combineType:"1",entity:{containerName:"",resourceId:"",mergeReasonId:"",dataPoints:[],ppcDataPoints:[]},description:"",dataPoints:[],ppcDataPoints:[],detailList:[],newContainer:[{containerName:"",qty:0}],columns:[{title:"批次名称",dataIndex:"containerName",key:"containerName"},{title:"数量",dataIndex:"qty",key:"qty"},{title:"合并数量",dataIndex:"mergeQty",key:"mergeQty"},{title:"操作",key:"action"}],newContainerColumns:[{title:"批次名称",dataIndex:"containerName",key:"containerName"},{title:"数量",dataIndex:"qty",key:"qty"}],rules:{mergeReasonId:[{required:!0,message:"请选择合并原因"}]}}},methods:{combineTypeChange(){this.refresh()},onSearch(t){t&&this.loadContainerInfo(t)},addDetailRow(){this.detailList.push({containerName:this.entity.containerName,qty:this.entity?.qty,mergeQty:0})},deleteDetailRow(t,e){this.detailList.splice(e,1)},resourceChange(t){},save(){this.$refs.form.validate().then((t=>{t&&(0,i.f7)({title:"签名确认",width:"600px"},{component:o.Z,success:()=>{this.submitCombine()}})}))},refresh(){this.entity={containerName:"",resourceId:"",mergeReasonId:"",dataPoints:[],ppcDataPoints:[]},this.description="",this.dataPoints=[],this.ppcDataPoints=[],this.detailList=[],this.newContainer=[{containerName:"",qty:0}]}}}),c=l,d=a(1001),u=(0,d.Z)(c,n,r,!1,null,"5b86c8a0",null),p=u.exports}}]);
//# sourceMappingURL=504.3c1c7091.js.map