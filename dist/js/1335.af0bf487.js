"use strict";(self["webpackChunkdata_v2"]=self["webpackChunkdata_v2"]||[]).push([[1335],{81335:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var n=function(){var e=this,t=e._self._c;return t("a-spin",{attrs:{spinning:e.loading}},[t("a-form-model",{ref:"ruleForm",attrs:{model:e.entity,rules:e.rules,"label-col":{span:5},"wrapper-col":{span:14}}},[t("div",{staticClass:"card"},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"工厂编码",prop:"factoryCode"}},[t("a-input",{attrs:{placeholder:"请输入工厂编码"},on:{change:t=>e.handleChange("factoryCode",t.target.value)},model:{value:e.entity.factoryCode,callback:function(t){e.$set(e.entity,"factoryCode",t)},expression:"entity.factoryCode"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"工厂名称",prop:"name"}},[t("a-input",{attrs:{placeholder:"请输入工厂名称"},on:{change:t=>e.handleChange("name",t.target.value)},model:{value:e.entity.name,callback:function(t){e.$set(e.entity,"name",t)},expression:"entity.name"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"工厂类型",prop:"factoryType"}},[t("a-select",{attrs:{placeholder:"请选择工厂类型"},on:{change:t=>e.handleChange("factoryType",t)},model:{value:e.entity.factoryType,callback:function(t){e.$set(e.entity,"factoryType",t)},expression:"entity.factoryType"}},[t("a-select-option",{attrs:{value:"生产工厂"}},[e._v("生产工厂")]),t("a-select-option",{attrs:{value:"组装工厂"}},[e._v("组装工厂")]),t("a-select-option",{attrs:{value:"加工工厂"}},[e._v("加工工厂")]),t("a-select-option",{attrs:{value:"储存中心"}},[e._v("储存中心")]),t("a-select-option",{attrs:{value:"物流中心"}},[e._v("物流中心")])],1)],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"所属企业",prop:"enterpriseId"}},[t("a-select",{attrs:{placeholder:"请选择所属企业"},on:{change:t=>e.handleChange("enterpriseId",t)},model:{value:e.entity.enterpriseId,callback:function(t){e.$set(e.entity,"enterpriseId",t)},expression:"entity.enterpriseId"}},[t("a-select-option",{attrs:{value:"1"}},[e._v("制造业企业1")]),t("a-select-option",{attrs:{value:"2"}},[e._v("电子信息企业2")]),t("a-select-option",{attrs:{value:"3"}},[e._v("汽车制造企业3")]),t("a-select-option",{attrs:{value:"4"}},[e._v("医药制造企业4")]),t("a-select-option",{attrs:{value:"5"}},[e._v("食品加工企业5")])],1)],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"建立日期",prop:"foundDate"}},[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD"},on:{change:(t,a)=>e.handleChange("foundDate",a)},model:{value:e.entity.foundDate,callback:function(t){e.$set(e.entity,"foundDate",t)},expression:"entity.foundDate"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"工厂面积",prop:"area"}},[t("a-input",{attrs:{placeholder:"请输入工厂面积"},on:{change:t=>e.handleChange("area",t.target.value)},scopedSlots:e._u([{key:"addonAfter",fn:function(){return[e._v("平方米")]},proxy:!0}]),model:{value:e.entity.area,callback:function(t){e.$set(e.entity,"area",t)},expression:"entity.area"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"生产线数量",prop:"productionLines"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0},on:{change:t=>e.handleChange("productionLines",t)},model:{value:e.entity.productionLines,callback:function(t){e.$set(e.entity,"productionLines",t)},expression:"entity.productionLines"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"生产能力",prop:"capacity"}},[t("a-input",{attrs:{placeholder:"请输入生产能力"},on:{change:t=>e.handleChange("capacity",t.target.value)},model:{value:e.entity.capacity,callback:function(t){e.$set(e.entity,"capacity",t)},expression:"entity.capacity"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"工厂地址",prop:"address"}},[t("a-textarea",{attrs:{placeholder:"请输入工厂地址","auto-size":{minRows:2,maxRows:6}},on:{change:t=>e.handleChange("address",t.target.value)},model:{value:e.entity.address,callback:function(t){e.$set(e.entity,"address",t)},expression:"entity.address"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"工厂负责人",prop:"manager"}},[t("a-input",{attrs:{placeholder:"请输入工厂负责人"},on:{change:t=>e.handleChange("manager",t.target.value)},model:{value:e.entity.manager,callback:function(t){e.$set(e.entity,"manager",t)},expression:"entity.manager"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"联系电话",prop:"contact"}},[t("a-input",{attrs:{placeholder:"请输入联系电话"},on:{change:t=>e.handleChange("contact",t.target.value)},model:{value:e.entity.contact,callback:function(t){e.$set(e.entity,"contact",t)},expression:"entity.contact"}})],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"运行状态",prop:"status"}},[t("a-select",{attrs:{placeholder:"请选择运行状态"},on:{change:t=>e.handleChange("status",t)},model:{value:e.entity.status,callback:function(t){e.$set(e.entity,"status",t)},expression:"entity.status"}},[t("a-select-option",{attrs:{value:"运行中"}},[e._v("运行中")]),t("a-select-option",{attrs:{value:"筹建中"}},[e._v("筹建中")]),t("a-select-option",{attrs:{value:"维护中"}},[e._v("维护中")]),t("a-select-option",{attrs:{value:"停产"}},[e._v("停产")])],1)],1)],1),t("a-col",{attrs:{sm:6}},[t("a-form-model-item",{attrs:{label:"描述",prop:"description"}},[t("a-textarea",{attrs:{placeholder:"请输入描述","auto-size":{minRows:2,maxRows:6}},on:{change:t=>e.handleChange("description",t.target.value)},model:{value:e.entity.description,callback:function(t){e.$set(e.entity,"description",t)},expression:"entity.description"}})],1)],1)],1)],1),t("g-collapse",{attrs:{headerName:"生产线信息"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-button",{attrs:{type:"primary"},on:{click:e.addProductionLine}},[t("a-icon",{attrs:{type:"plus"}}),e._v("新增生产线 ")],1),t("a-table",{staticStyle:{"margin-top":"10px"},attrs:{columns:e.productionLineColumns,"data-source":e.entity.productionLines,rowKey:"id",pagination:!1,scroll:{y:300}},scopedSlots:e._u([{key:"sequence",fn:function({text:t,record:a,index:n}){return[e._v(" "+e._s(n+1)+" ")]}},{key:"lineCode",fn:function({text:a,record:n}){return[t("a-input",{attrs:{placeholder:"请输入生产线编码"},on:{change:t=>e.updateProductionLine(n,"lineCode",t.target.value)},model:{value:n.lineCode,callback:function(t){e.$set(n,"lineCode",t)},expression:"record.lineCode"}})]}},{key:"lineName",fn:function({text:a,record:n}){return[t("a-input",{attrs:{placeholder:"请输入生产线名称"},on:{change:t=>e.updateProductionLine(n,"lineName",t.target.value)},model:{value:n.lineName,callback:function(t){e.$set(n,"lineName",t)},expression:"record.lineName"}})]}},{key:"lineType",fn:function({text:a,record:n}){return[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择生产线类型"},on:{change:t=>e.updateProductionLine(n,"lineType",t)},model:{value:n.lineType,callback:function(t){e.$set(n,"lineType",t)},expression:"record.lineType"}},[t("a-select-option",{attrs:{value:"组装线"}},[e._v("组装线")]),t("a-select-option",{attrs:{value:"包装线"}},[e._v("包装线")]),t("a-select-option",{attrs:{value:"生产线"}},[e._v("生产线")]),t("a-select-option",{attrs:{value:"检测线"}},[e._v("检测线")])],1)]}},{key:"capacity",fn:function({text:a,record:n}){return[t("a-input",{attrs:{placeholder:"请输入产能"},on:{change:t=>e.updateProductionLine(n,"capacity",t.target.value)},model:{value:n.capacity,callback:function(t){e.$set(n,"capacity",t)},expression:"record.capacity"}})]}},{key:"operation",fn:function({text:a,record:n}){return[t("a-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.removeProductionLine(n)}}},[t("a-icon",{attrs:{type:"delete"}}),e._v("移除 ")],1)]}}])})]},proxy:!0}])}),t("g-collapse",{attrs:{headerName:"设备信息"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-button",{attrs:{type:"primary"},on:{click:e.addEquipment}},[t("a-icon",{attrs:{type:"plus"}}),e._v("新增设备 ")],1),t("a-table",{attrs:{columns:e.equipmentColumns,"data-source":e.entity.equipments,rowKey:"id",pagination:!1,scroll:{y:300}},scopedSlots:e._u([{key:"sequence",fn:function({text:t,record:a,index:n}){return[e._v(" "+e._s(n+1)+" ")]}},{key:"equipCode",fn:function({text:a,record:n}){return[t("a-input",{attrs:{placeholder:"请输入设备编码"},on:{change:t=>e.updateEquipment(n,"equipCode",t.target.value)},model:{value:n.equipCode,callback:function(t){e.$set(n,"equipCode",t)},expression:"record.equipCode"}})]}},{key:"equipName",fn:function({text:a,record:n}){return[t("a-input",{attrs:{placeholder:"请输入设备名称"},on:{change:t=>e.updateEquipment(n,"equipName",t.target.value)},model:{value:n.equipName,callback:function(t){e.$set(n,"equipName",t)},expression:"record.equipName"}})]}},{key:"equipType",fn:function({text:a,record:n}){return[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择设备类型"},on:{change:t=>e.updateEquipment(n,"equipType",t)},model:{value:n.equipType,callback:function(t){e.$set(n,"equipType",t)},expression:"record.equipType"}},[t("a-select-option",{attrs:{value:"生产设备"}},[e._v("生产设备")]),t("a-select-option",{attrs:{value:"检测设备"}},[e._v("检测设备")]),t("a-select-option",{attrs:{value:"辅助设备"}},[e._v("辅助设备")]),t("a-select-option",{attrs:{value:"运输设备"}},[e._v("运输设备")])],1)]}},{key:"lineId",fn:function({text:a,record:n}){return[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择所属生产线"},on:{change:t=>e.updateEquipment(n,"lineId",t)},model:{value:n.lineId,callback:function(t){e.$set(n,"lineId",t)},expression:"record.lineId"}},e._l(e.entity.productionLines,(function(a){return t("a-select-option",{key:a.id,attrs:{value:a.id}},[e._v(" "+e._s(a.lineName)+" ")])})),1)]}},{key:"status",fn:function({text:a,record:n}){return[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择设备状态"},on:{change:t=>e.updateEquipment(n,"status",t)},model:{value:n.status,callback:function(t){e.$set(n,"status",t)},expression:"record.status"}},[t("a-select-option",{attrs:{value:"运行中"}},[e._v("运行中")]),t("a-select-option",{attrs:{value:"空闲中"}},[e._v("空闲中")]),t("a-select-option",{attrs:{value:"维护中"}},[e._v("维护中")]),t("a-select-option",{attrs:{value:"故障"}},[e._v("故障")])],1)]}},{key:"operation",fn:function({text:a,record:n}){return[t("a-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.removeEquipment(n)}}},[t("a-icon",{attrs:{type:"delete"}}),e._v("移除 ")],1)]}}])})]},proxy:!0}])}),t("g-collapse",{attrs:{headerName:"详细信息"},scopedSlots:e._u([{key:"content",fn:function(){return[t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"创建人"}},[t("a-input",{attrs:{disabled:""},model:{value:e.entity.createdBy,callback:function(t){e.$set(e.entity,"createdBy",t)},expression:"entity.createdBy"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"创建时间"}},[t("a-input",{attrs:{disabled:""},model:{value:e.entity.createdTime,callback:function(t){e.$set(e.entity,"createdTime",t)},expression:"entity.createdTime"}})],1)],1)],1),t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"修改人"}},[t("a-input",{attrs:{disabled:""},model:{value:e.entity.modifiedBy,callback:function(t){e.$set(e.entity,"modifiedBy",t)},expression:"entity.modifiedBy"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"修改时间"}},[t("a-input",{attrs:{disabled:""},model:{value:e.entity.modifiedTime,callback:function(t){e.$set(e.entity,"modifiedTime",t)},expression:"entity.modifiedTime"}})],1)],1)],1)]},proxy:!0}])})],1)],1)},i=[],o=a(36026),r={name:"CreateOrEditFactory",mixins:[o.GE],data(){return{entity:{},loading:!1,rules:{factoryCode:[{required:!0,message:"请输入工厂编码",trigger:"blur"},{pattern:/^FC\d{4}$/,message:"工厂编码必须为FC+4位数字",trigger:"blur"}],name:[{required:!0,message:"请输入工厂名称",trigger:"blur"}],factoryType:[{required:!0,message:"请选择工厂类型",trigger:"change"}],enterpriseId:[{required:!0,message:"请选择所属企业",trigger:"change"}],foundDate:[{required:!0,message:"请选择建立日期",trigger:"change"}],area:[{required:!0,message:"请输入工厂面积",trigger:"blur"}],productionLines:[{required:!0,message:"请输入生产线数量",trigger:"change"},{type:"number",message:"生产线数量必须为数字",trigger:"change"}],capacity:[{required:!0,message:"请输入生产能力",trigger:"blur"}],address:[{required:!0,message:"请输入工厂地址",trigger:"blur"}],manager:[{required:!0,message:"请输入工厂负责人",trigger:"blur"}],contact:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1\d{10}$/,message:"请输入正确的手机号码",trigger:"blur"}],status:[{required:!0,message:"请选择运行状态",trigger:"change"}]},productionLineColumns:[{title:"序号",dataIndex:"sequence",key:"sequence",width:80,scopedSlots:{customRender:"sequence"}},{title:"生产线编码",dataIndex:"lineCode",key:"lineCode",width:150,scopedSlots:{customRender:"lineCode"}},{title:"生产线名称",dataIndex:"lineName",key:"lineName",width:150,scopedSlots:{customRender:"lineName"}},{title:"生产线类型",dataIndex:"lineType",key:"lineType",width:150,scopedSlots:{customRender:"lineType"}},{title:"产能",dataIndex:"capacity",key:"capacity",width:150,scopedSlots:{customRender:"capacity"}},{title:"操作",key:"operation",width:100,fixed:"right",scopedSlots:{customRender:"operation"}}],equipmentColumns:[{title:"序号",dataIndex:"sequence",key:"sequence",width:60,scopedSlots:{customRender:"sequence"}},{title:"设备编码",dataIndex:"equipCode",key:"equipCode",width:120,scopedSlots:{customRender:"equipCode"}},{title:"设备名称",dataIndex:"equipName",key:"equipName",width:150,scopedSlots:{customRender:"equipName"}},{title:"设备类型",dataIndex:"equipType",key:"equipType",width:120,scopedSlots:{customRender:"equipType"}},{title:"所属生产线",dataIndex:"lineId",key:"lineId",width:150,scopedSlots:{customRender:"lineId"}},{title:"设备状态",dataIndex:"status",key:"status",width:120,scopedSlots:{customRender:"status"}},{title:"操作",key:"operation",width:100,fixed:"right",scopedSlots:{customRender:"operation"}}]}},created(){this.initializeEntity()},methods:{initializeEntity(){this.entity||(this.entity={factoryCode:"",name:"",factoryType:"",enterpriseId:void 0,enterpriseName:"",foundDate:"",area:"",productionLines:[],equipments:[],capacity:"",address:"",manager:"",contact:"",status:"筹建中",description:"",createdBy:"admin",createdTime:(new Date).toLocaleString(),modifiedBy:"admin",modifiedTime:(new Date).toLocaleString()})},handleChange(e,t){if(this.entity[e]=t,"enterpriseId"===e){const e=[{id:1,name:"制造业企业1"},{id:2,name:"电子信息企业2"},{id:3,name:"汽车制造企业3"},{id:4,name:"医药制造企业4"},{id:5,name:"食品加工企业5"}],a=e.find((e=>e.id==t));a&&(this.entity.enterpriseName=a.name)}},addProductionLine(){Array.isArray(this.entity.productionLines)||(this.entity.productionLines=[]);const e=this.entity.productionLines.length+1;this.entity.productionLines.push({id:Date.now(),lineCode:`PL${String(e).padStart(3,"0")}`,lineName:`生产线${e}`,lineType:"生产线",capacity:"100件/小时"})},updateProductionLine(e,t,a){e[t]=a},removeProductionLine(e){const t=this.entity.productionLines.findIndex((t=>t.id===e.id));-1!==t&&(this.entity.productionLines.splice(t,1),this.entity.equipments&&this.entity.equipments.forEach((t=>{t.lineId===e.id&&(t.lineId=void 0)})))},addEquipment(){Array.isArray(this.entity.equipments)||(this.entity.equipments=[]);const e=this.entity.equipments.length+1;this.entity.equipments.push({id:Date.now(),equipCode:`EQ${String(e).padStart(3,"0")}`,equipName:`设备${e}`,equipType:"生产设备",lineId:this.entity.productionLines&&this.entity.productionLines.length>0?this.entity.productionLines[0].id:void 0,status:"运行中"})},updateEquipment(e,t,a){e[t]=a},removeEquipment(e){const t=this.entity.equipments.findIndex((t=>t.id===e.id));-1!==t&&this.entity.equipments.splice(t,1)},save(){this.$refs.ruleForm.validate((e=>e?(console.log("表单校验通过，开始保存",this.entity),this.loading=!0,setTimeout((()=>{this.loading=!1,this.$message.success("保存成功"),this.entity.modifiedTime=(new Date).toLocaleString(),this.entity.modifiedBy="admin",this.isEdit||(this.entity.createdTime=(new Date).toLocaleString(),this.entity.createdBy="admin")}),1e3),!0):(console.log("表单校验失败"),!1)))}}},s=r,l=a(1001),c=(0,l.Z)(s,n,i,!1,null,"184234a0",null),d=c.exports}}]);
//# sourceMappingURL=1335.af0bf487.js.map